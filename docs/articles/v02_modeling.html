<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>flexsdm: Overview of Modeling functions • flexsdm</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="flexsdm: Overview of Modeling functions">
<meta name="google-site-verification" content="gcou8tqRTwNjZ_Mf1kbFgAzzUcY3OF-JB2sPRPTA56I">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">flexsdm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Home"><span class="fa fa-home"></span> Home</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/v01_pre_modeling.html">1. Overview of Pre-modeling functions</a></li>
    <li><a class="dropdown-item" href="../articles/v02_modeling.html">2. Overview of Modeling functions</a></li>
    <li><a class="dropdown-item" href="../articles/v03_post_modeling.html">3. Overview of Post-modeling functions</a></li>
    <li><a class="dropdown-item" href="../articles/v04_Red_fir_example.html">4. An example with Red Fir</a></li>
    <li><a class="dropdown-item" href="../articles/v05_Rare_species_example.html">5. Modeling a rare species</a></li>
    <li><a class="dropdown-item" href="../articles/v06_Extrapolation_example.html">6. Tools to explore extrapolation in SDMs</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/pkg_citation.html">Citations</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../articles/pkg_citation.html">Citations</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
<li class="nav-item"><a class="nav-link" href="https://sjevelazco.github.io/flexsdm" aria-label="GitHub">GitHub</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sjevelazco/flexsdm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>flexsdm: Overview of Modeling functions</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/sjevelazco/flexsdm/blob/HEAD/vignettes/v02_modeling.Rmd" class="external-link"><code>vignettes/v02_modeling.Rmd</code></a></small>
      <div class="d-none name"><code>v02_modeling.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Species distribution modeling (SDM) has become a standard tool in
multiple research areas, including ecology, conservation biology,
biogeography, paleobiogeography, and epidemiology. SDM is an area of
active theoretical and methodological research. The <em>flexsdm</em>
package provides users the ability to manipulate and parameterize models
in a variety of ways that meet their unique research needs.</p>
<p>This flexibility enables users to define their own complete or
partial modeling procedure specific for their modeling situations (e.g.,
number of variables, number of records, different algorithms and
ensemble methods, algorithms tuning, etc.).</p>
<p>In this vignette, users will learn about the second set of functions
in the <em>flexsdm</em> package that fall under the “modeling” umbrella.
These functions were designed to construct and validate different types
of models and can be grouped into fit_* , tune_* , and esm_* family
functions. In addition there is a function to perform ensemble
modeling.</p>
<p>The fit_* functions construct and validate models with default
hyper-parameter values. The tune_* functions construct and validate
models by searching for the best combination of hyper-parameter values,
and esm_ functions can be used for constructing and validating Ensemble
of Small Models. Finally, the fit_ensemble() function is for fitting and
validating ensemble models.</p>
<p>These are the functions for model construction and validation:</p>
<p><strong>fit_* functions family</strong></p>
<ul>
<li><p>fit_gam() Fit and validate Generalized Additive Models</p></li>
<li><p>fit_gau() Fit and validate Gaussian Process models</p></li>
<li><p>fit_gbm() Fit and validate Generalized Boosted Regression
models</p></li>
<li><p>fit_glm() Fit and validate Generalized Linear Models</p></li>
<li><p>fit_max() Fit and validate Maximum Entropy models</p></li>
<li><p>fit_net() Fit and validate Neural Networks models</p></li>
<li><p>fit_raf() Fit and validate Random Forest models</p></li>
<li><p>fit_svm() Fit and validate Support Vector Machine models</p></li>
</ul>
<p><strong>tune_* functions family</strong></p>
<ul>
<li><p>tune_gbm() Fit and validate Generalized Boosted Regression models
with exploration of hyper-parameters</p></li>
<li><p>tune_max() Fit and validate Maximum Entropy models with
exploration of hyper-parameters</p></li>
<li><p>tune_net() Fit and validate Neural Networks models with
exploration of hyper-parameters</p></li>
<li><p>tune_raf() Fit and validate Random Forest models with exploration
of hyper-parameters</p></li>
<li><p>tune_svm() Fit and validate Support Vector Machine models with
exploration of hyper-parameters</p></li>
</ul>
<p><strong>model ensemble</strong></p>
<ul>
<li>fit_ensemble() Fit and validate ensemble models with different
ensemble methods</li>
</ul>
<p><strong>esm_* functions family</strong></p>
<ul>
<li><p>esm_gam() Fit and validate Generalized Additive Models with
Ensemble of Small Model approach</p></li>
<li><p>esm_gau() Fit and validate Gaussian Process models Models with
Ensemble of Small Model approach</p></li>
<li><p>esm_gbm() Fit and validate Generalized Boosted Regression models
with Ensemble of Small Model approach</p></li>
<li><p>esm_glm() Fit and validate Generalized Linear Models with
Ensemble of Small Model approach</p></li>
<li><p>esm_max() Fit and validate Maximum Entropy models with Ensemble
of Small Model approach</p></li>
<li><p>esm_net() Fit and validate Neural Networks models with Ensemble
of Small Model approach</p></li>
<li><p>esm_svm() Fit and validate Support Vector Machine models with
Ensemble of Small Model approach</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>First, install the flexsdm package. You can install the released
version of <em>flexsdm</em> from <a href="https://github.com/sjevelazco/flexsdm" class="external-link">github</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># devtools::install_github('sjevelazco/flexsdm')</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://sjevelazco.github.io/flexsdm">flexsdm</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: flexsdm</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: terra</span></span>
<span><span class="co">#&gt; terra 1.8.60</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'terra'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:knitr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     spin</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: dplyr</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:terra':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, union</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="project-directory-setup">Project directory setup<a class="anchor" aria-label="anchor" href="#project-directory-setup"></a>
</h2>
<p>Decide where on your computer you would like to store the inputs and
outputs of your project (this will be your main directory). Use an
existing one or use dir.create() to create your main directory. Then
specify whether or not to include folders for projections, calibration
areas, algorithms, ensembles, and thresholds. For more details see <a href="https://sjevelazco.github.io/flexsdm/articles/01_pre_modeling.html">Vignette
01_pre_modeling</a></p>
</div>
<div class="section level2">
<h2 id="data-species-occurrence-and-background-data">Data, species occurrence and background data<a class="anchor" aria-label="anchor" href="#data-species-occurrence-and-background-data"></a>
</h2>
<p>In this tutorial, we will be using species occurrences and
environmental data that are available through the <em>flexsdm</em>
package. The “abies” example dataset includes a pr_ab column (presence =
1, and absence = 0), location columns (x, y) and other environmental
data. You can load the “abies” data into your local R environment by
using the code below:</p>
<p>(THIS EXAMPLE LOOKS A LITTLE STRANGE BECAUSE WE ARE ALSO USING
BACKGROUND DATA, WHILE THE ABIES DATASET CLEARLY HAS ABSENCES…)</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"abies"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"backg"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">abies</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 1,400</span></span>
<span><span class="co">#&gt; Columns: 13</span></span>
<span><span class="co">#&gt; $ id       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 715<span style="color: #949494;">, </span>5680<span style="color: #949494;">, </span>7907<span style="color: #949494;">, </span>1850<span style="color: #949494;">, </span>1702<span style="color: #949494;">, </span>10036<span style="color: #949494;">, </span>12384<span style="color: #949494;">, </span>6513<span style="color: #949494;">, </span>9884<span style="color: #949494;">, </span>8651<span style="color: #949494;">, </span>…</span></span>
<span><span class="co">#&gt; $ pr_ab    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0…</span></span>
<span><span class="co">#&gt; $ x        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> -95417.134<span style="color: #949494;">, </span>98986.536<span style="color: #949494;">, </span>121474.257<span style="color: #949494;">, </span>-39976.221<span style="color: #949494;">, </span>111372.261<span style="color: #949494;">, </span>-2…</span></span>
<span><span class="co">#&gt; $ y        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 314240.13<span style="color: #949494;">, </span>-159415.18<span style="color: #949494;">, </span>-99463.44<span style="color: #949494;">, </span>-17456.11<span style="color: #949494;">, </span>-91404.05<span style="color: #949494;">, </span>39222…</span></span>
<span><span class="co">#&gt; $ aet      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 323.1133<span style="color: #949494;">, </span>447.5567<span style="color: #949494;">, </span>182.2833<span style="color: #949494;">, </span>372.3867<span style="color: #949494;">, </span>209.4567<span style="color: #949494;">, </span>308.3000<span style="color: #949494;">, </span>5…</span></span>
<span><span class="co">#&gt; $ cwd      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 546.1400<span style="color: #949494;">, </span>815.4033<span style="color: #949494;">, </span>271.1800<span style="color: #949494;">, </span>946.2933<span style="color: #949494;">, </span>398.5500<span style="color: #949494;">, </span>534.9533<span style="color: #949494;">, </span>3…</span></span>
<span><span class="co">#&gt; $ tmin     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1.2433<span style="color: #949494;">, </span>9.4267<span style="color: #949494;">, </span>-4.9500<span style="color: #949494;">, </span>8.7767<span style="color: #949494;">, </span>-4.0333<span style="color: #949494;">, </span>4.6600<span style="color: #949494;">, </span>4.3800<span style="color: #949494;">, </span>4.9…</span></span>
<span><span class="co">#&gt; $ ppt_djf  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 62.7257<span style="color: #949494;">, </span>129.6406<span style="color: #949494;">, </span>150.7003<span style="color: #949494;">, </span>116.0236<span style="color: #949494;">, </span>164.9327<span style="color: #949494;">, </span>166.2220<span style="color: #949494;">, </span>48…</span></span>
<span><span class="co">#&gt; $ ppt_jja  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 17.7941<span style="color: #949494;">, </span>6.4317<span style="color: #949494;">, </span>11.2294<span style="color: #949494;">, </span>2.7020<span style="color: #949494;">, </span>9.2686<span style="color: #949494;">, </span>16.5310<span style="color: #949494;">, </span>41.2494<span style="color: #949494;">, </span>8…</span></span>
<span><span class="co">#&gt; $ pH       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 5.773341<span style="color: #949494;">, </span>5.600000<span style="color: #949494;">, </span>0.000000<span style="color: #949494;">, </span>6.411796<span style="color: #949494;">, </span>0.000000<span style="color: #949494;">, </span>5.700000<span style="color: #949494;">, </span>5…</span></span>
<span><span class="co">#&gt; $ awc      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.10837019<span style="color: #949494;">, </span>0.16000000<span style="color: #949494;">, </span>0.00000000<span style="color: #949494;">, </span>0.09719457<span style="color: #949494;">, </span>0.00000000<span style="color: #949494;">, </span>0…</span></span>
<span><span class="co">#&gt; $ depth    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 152.000000<span style="color: #949494;">, </span>201.000000<span style="color: #949494;">, </span>0.000000<span style="color: #949494;">, </span>59.759930<span style="color: #949494;">, </span>0.000000<span style="color: #949494;">, </span>112.99…</span></span>
<span><span class="co">#&gt; $ landform <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> 7<span style="color: #949494;">, </span>11<span style="color: #949494;">, </span>15<span style="color: #949494;">, </span>14<span style="color: #949494;">, </span>15<span style="color: #949494;">, </span>15<span style="color: #949494;">, </span>7<span style="color: #949494;">, </span>15<span style="color: #949494;">, </span>4<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>6<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>15<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>11<span style="color: #949494;">, </span>1…</span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">backg</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 5,000</span></span>
<span><span class="co">#&gt; Columns: 13</span></span>
<span><span class="co">#&gt; $ pr_ab        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>…</span></span>
<span><span class="co">#&gt; $ x            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 160779.16<span style="color: #949494;">, </span>36849.16<span style="color: #949494;">, </span>-240170.84<span style="color: #949494;">, </span>-152420.84<span style="color: #949494;">, </span>-193190.84<span style="color: #949494;">, </span>…</span></span>
<span><span class="co">#&gt; $ y            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> -449968.33<span style="color: #949494;">, </span>24151.67<span style="color: #949494;">, </span>90031.67<span style="color: #949494;">, </span>-143518.33<span style="color: #949494;">, </span>24151.67<span style="color: #949494;">, </span>223…</span></span>
<span><span class="co">#&gt; $ aet          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 280.4567<span style="color: #949494;">, </span>259.7800<span style="color: #949494;">, </span>400.1767<span style="color: #949494;">, </span>367.4833<span style="color: #949494;">, </span>397.3667<span style="color: #949494;">, </span>385.263…</span></span>
<span><span class="co">#&gt; $ cwd          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1137.2433<span style="color: #949494;">, </span>381.5367<span style="color: #949494;">, </span>699.6500<span style="color: #949494;">, </span>843.4467<span style="color: #949494;">, </span>842.3833<span style="color: #949494;">, </span>637.35…</span></span>
<span><span class="co">#&gt; $ tmin         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 13.5100<span style="color: #949494;">, </span>-3.1733<span style="color: #949494;">, </span>8.6800<span style="color: #949494;">, </span>9.0133<span style="color: #949494;">, </span>8.9700<span style="color: #949494;">, </span>4.9333<span style="color: #949494;">, </span>6.2933<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ ppt_djf      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 71.2741<span style="color: #949494;">, </span>171.4537<span style="color: #949494;">, </span>285.0893<span style="color: #949494;">, </span>72.0309<span style="color: #949494;">, </span>125.2467<span style="color: #949494;">, </span>226.1534<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ ppt_jja      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1.1920<span style="color: #949494;">, </span>17.5193<span style="color: #949494;">, </span>5.0158<span style="color: #949494;">, </span>1.2047<span style="color: #949494;">, </span>1.9778<span style="color: #949494;">, </span>8.1554<span style="color: #949494;">, </span>18.4182<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ pH           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.0000000<span style="color: #949494;">, </span>0.2122687<span style="color: #949494;">, </span>5.7222223<span style="color: #949494;">, </span>7.5350823<span style="color: #949494;">, </span>6.1963525<span style="color: #949494;">, </span>5.…</span></span>
<span><span class="co">#&gt; $ awc          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.000000000<span style="color: #949494;">, </span>0.003473487<span style="color: #949494;">, </span>0.080370426<span style="color: #949494;">, </span>0.170000002<span style="color: #949494;">, </span>0.131…</span></span>
<span><span class="co">#&gt; $ depth        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.00000<span style="color: #949494;">, </span>201.00000<span style="color: #949494;">, </span>50.07409<span style="color: #949494;">, </span>154.39426<span style="color: #949494;">, </span>122.39575<span style="color: #949494;">, </span>56.17…</span></span>
<span><span class="co">#&gt; $ percent_clay <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.0000000<span style="color: #949494;">, </span>0.4438345<span style="color: #949494;">, </span>18.4111176<span style="color: #949494;">, </span>46.9751244<span style="color: #949494;">, </span>37.1873169<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ landform     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> 13<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>6<span style="color: #949494;">, </span>6<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>14<span style="color: #949494;">, </span>8<span style="color: #949494;">, </span>14<span style="color: #949494;">, </span>6<span style="color: #949494;">, </span>7<span style="color: #949494;">, </span>11<span style="color: #949494;">, </span>14<span style="color: #949494;">, </span>14<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>6<span style="color: #949494;">, </span>6<span style="color: #949494;">, </span>…</span></span></code></pre></div>
<p>If you want to replace the abies dataset with your own data, make
sure that your dataset contains the environmental conditions related to
presence-absence data. We use a pre-modeling family function for a
k-fold partition method (to be used for cross-validation). In the
partition method the number of folds or replications must be the same
for presence-absence and for background points datasets.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">abies2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/part_random.html">part_random</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">abies</span>,</span>
<span>  pr_ab <span class="op">=</span> <span class="st">"pr_ab"</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"kfold"</span>, folds <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">abies2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 1,400</span></span>
<span><span class="co">#&gt; Columns: 14</span></span>
<span><span class="co">#&gt; $ id       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 715<span style="color: #949494;">, </span>5680<span style="color: #949494;">, </span>7907<span style="color: #949494;">, </span>1850<span style="color: #949494;">, </span>1702<span style="color: #949494;">, </span>10036<span style="color: #949494;">, </span>12384<span style="color: #949494;">, </span>6513<span style="color: #949494;">, </span>9884<span style="color: #949494;">, </span>8651<span style="color: #949494;">, </span>…</span></span>
<span><span class="co">#&gt; $ pr_ab    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0…</span></span>
<span><span class="co">#&gt; $ x        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> -95417.134<span style="color: #949494;">, </span>98986.536<span style="color: #949494;">, </span>121474.257<span style="color: #949494;">, </span>-39976.221<span style="color: #949494;">, </span>111372.261<span style="color: #949494;">, </span>-2…</span></span>
<span><span class="co">#&gt; $ y        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 314240.13<span style="color: #949494;">, </span>-159415.18<span style="color: #949494;">, </span>-99463.44<span style="color: #949494;">, </span>-17456.11<span style="color: #949494;">, </span>-91404.05<span style="color: #949494;">, </span>39222…</span></span>
<span><span class="co">#&gt; $ aet      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 323.1133<span style="color: #949494;">, </span>447.5567<span style="color: #949494;">, </span>182.2833<span style="color: #949494;">, </span>372.3867<span style="color: #949494;">, </span>209.4567<span style="color: #949494;">, </span>308.3000<span style="color: #949494;">, </span>5…</span></span>
<span><span class="co">#&gt; $ cwd      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 546.1400<span style="color: #949494;">, </span>815.4033<span style="color: #949494;">, </span>271.1800<span style="color: #949494;">, </span>946.2933<span style="color: #949494;">, </span>398.5500<span style="color: #949494;">, </span>534.9533<span style="color: #949494;">, </span>3…</span></span>
<span><span class="co">#&gt; $ tmin     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1.2433<span style="color: #949494;">, </span>9.4267<span style="color: #949494;">, </span>-4.9500<span style="color: #949494;">, </span>8.7767<span style="color: #949494;">, </span>-4.0333<span style="color: #949494;">, </span>4.6600<span style="color: #949494;">, </span>4.3800<span style="color: #949494;">, </span>4.9…</span></span>
<span><span class="co">#&gt; $ ppt_djf  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 62.7257<span style="color: #949494;">, </span>129.6406<span style="color: #949494;">, </span>150.7003<span style="color: #949494;">, </span>116.0236<span style="color: #949494;">, </span>164.9327<span style="color: #949494;">, </span>166.2220<span style="color: #949494;">, </span>48…</span></span>
<span><span class="co">#&gt; $ ppt_jja  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 17.7941<span style="color: #949494;">, </span>6.4317<span style="color: #949494;">, </span>11.2294<span style="color: #949494;">, </span>2.7020<span style="color: #949494;">, </span>9.2686<span style="color: #949494;">, </span>16.5310<span style="color: #949494;">, </span>41.2494<span style="color: #949494;">, </span>8…</span></span>
<span><span class="co">#&gt; $ pH       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 5.773341<span style="color: #949494;">, </span>5.600000<span style="color: #949494;">, </span>0.000000<span style="color: #949494;">, </span>6.411796<span style="color: #949494;">, </span>0.000000<span style="color: #949494;">, </span>5.700000<span style="color: #949494;">, </span>5…</span></span>
<span><span class="co">#&gt; $ awc      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.10837019<span style="color: #949494;">, </span>0.16000000<span style="color: #949494;">, </span>0.00000000<span style="color: #949494;">, </span>0.09719457<span style="color: #949494;">, </span>0.00000000<span style="color: #949494;">, </span>0…</span></span>
<span><span class="co">#&gt; $ depth    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 152.000000<span style="color: #949494;">, </span>201.000000<span style="color: #949494;">, </span>0.000000<span style="color: #949494;">, </span>59.759930<span style="color: #949494;">, </span>0.000000<span style="color: #949494;">, </span>112.99…</span></span>
<span><span class="co">#&gt; $ landform <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> 7<span style="color: #949494;">, </span>11<span style="color: #949494;">, </span>15<span style="color: #949494;">, </span>14<span style="color: #949494;">, </span>15<span style="color: #949494;">, </span>15<span style="color: #949494;">, </span>7<span style="color: #949494;">, </span>15<span style="color: #949494;">, </span>4<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>6<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>15<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>11<span style="color: #949494;">, </span>1…</span></span>
<span><span class="co">#&gt; $ .part    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 3<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>5<span style="color: #949494;">, </span>3<span style="color: #949494;">, </span>5<span style="color: #949494;">, </span>4<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>5<span style="color: #949494;">, </span>4<span style="color: #949494;">, </span>5<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>5…</span></span></code></pre></div>
<p>Now, in the abies2 object we have a new column called “.part” with
the 5 k-folds (1, 2, 3, 4, 5), indicating which partition each record
(row) is a member of. Next, we have to apply the same partition method
and number of folds to the environmental conditions of the background
points.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">backg2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/part_random.html">part_random</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">backg</span>,</span>
<span>  pr_ab <span class="op">=</span> <span class="st">"pr_ab"</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"kfold"</span>, folds <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">backg2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 5,000</span></span>
<span><span class="co">#&gt; Columns: 14</span></span>
<span><span class="co">#&gt; $ pr_ab        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>…</span></span>
<span><span class="co">#&gt; $ x            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 160779.16<span style="color: #949494;">, </span>36849.16<span style="color: #949494;">, </span>-240170.84<span style="color: #949494;">, </span>-152420.84<span style="color: #949494;">, </span>-193190.84<span style="color: #949494;">, </span>…</span></span>
<span><span class="co">#&gt; $ y            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> -449968.33<span style="color: #949494;">, </span>24151.67<span style="color: #949494;">, </span>90031.67<span style="color: #949494;">, </span>-143518.33<span style="color: #949494;">, </span>24151.67<span style="color: #949494;">, </span>223…</span></span>
<span><span class="co">#&gt; $ aet          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 280.4567<span style="color: #949494;">, </span>259.7800<span style="color: #949494;">, </span>400.1767<span style="color: #949494;">, </span>367.4833<span style="color: #949494;">, </span>397.3667<span style="color: #949494;">, </span>385.263…</span></span>
<span><span class="co">#&gt; $ cwd          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1137.2433<span style="color: #949494;">, </span>381.5367<span style="color: #949494;">, </span>699.6500<span style="color: #949494;">, </span>843.4467<span style="color: #949494;">, </span>842.3833<span style="color: #949494;">, </span>637.35…</span></span>
<span><span class="co">#&gt; $ tmin         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 13.5100<span style="color: #949494;">, </span>-3.1733<span style="color: #949494;">, </span>8.6800<span style="color: #949494;">, </span>9.0133<span style="color: #949494;">, </span>8.9700<span style="color: #949494;">, </span>4.9333<span style="color: #949494;">, </span>6.2933<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ ppt_djf      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 71.2741<span style="color: #949494;">, </span>171.4537<span style="color: #949494;">, </span>285.0893<span style="color: #949494;">, </span>72.0309<span style="color: #949494;">, </span>125.2467<span style="color: #949494;">, </span>226.1534<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ ppt_jja      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1.1920<span style="color: #949494;">, </span>17.5193<span style="color: #949494;">, </span>5.0158<span style="color: #949494;">, </span>1.2047<span style="color: #949494;">, </span>1.9778<span style="color: #949494;">, </span>8.1554<span style="color: #949494;">, </span>18.4182<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ pH           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.0000000<span style="color: #949494;">, </span>0.2122687<span style="color: #949494;">, </span>5.7222223<span style="color: #949494;">, </span>7.5350823<span style="color: #949494;">, </span>6.1963525<span style="color: #949494;">, </span>5.…</span></span>
<span><span class="co">#&gt; $ awc          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.000000000<span style="color: #949494;">, </span>0.003473487<span style="color: #949494;">, </span>0.080370426<span style="color: #949494;">, </span>0.170000002<span style="color: #949494;">, </span>0.131…</span></span>
<span><span class="co">#&gt; $ depth        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.00000<span style="color: #949494;">, </span>201.00000<span style="color: #949494;">, </span>50.07409<span style="color: #949494;">, </span>154.39426<span style="color: #949494;">, </span>122.39575<span style="color: #949494;">, </span>56.17…</span></span>
<span><span class="co">#&gt; $ percent_clay <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.0000000<span style="color: #949494;">, </span>0.4438345<span style="color: #949494;">, </span>18.4111176<span style="color: #949494;">, </span>46.9751244<span style="color: #949494;">, </span>37.1873169<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ landform     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> 13<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>6<span style="color: #949494;">, </span>6<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>14<span style="color: #949494;">, </span>8<span style="color: #949494;">, </span>14<span style="color: #949494;">, </span>6<span style="color: #949494;">, </span>7<span style="color: #949494;">, </span>11<span style="color: #949494;">, </span>14<span style="color: #949494;">, </span>14<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>6<span style="color: #949494;">, </span>6<span style="color: #949494;">, </span>…</span></span>
<span><span class="co">#&gt; $ .part        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 4<span style="color: #949494;">, </span>4<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>5<span style="color: #949494;">, </span>5<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>5<span style="color: #949494;">, </span>3<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>5<span style="color: #949494;">, </span>4<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>4<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>5<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>5<span style="color: #949494;">, </span>4<span style="color: #949494;">, </span>…</span></span></code></pre></div>
<p>In backg2 object we have a new column called “.part” with the 5
k-folds (1, 2, 3, 4, 5).</p>
<div class="section level3">
<h3 id="fit-and-validate-models">1. Fit and validate models<a class="anchor" aria-label="anchor" href="#fit-and-validate-models"></a>
</h3>
<p>We fit and validate models: I. a maximum entropy model with default
hyper-parameter values (flexsdm::fit_max) and II. a random forest model
with exploration of hyper-parameters (flexsdm::tune_raf).</p>
<p>I. Maximum Entropy models with default hyper-parameter values.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">max_t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_max.html">fit_max</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">abies2</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"pr_ab"</span>,</span>
<span>  predictors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"aet"</span>, <span class="st">"ppt_jja"</span>, <span class="st">"pH"</span>, <span class="st">"awc"</span>, <span class="st">"depth"</span><span class="op">)</span>,</span>
<span>  predictors_f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"landform"</span><span class="op">)</span>,</span>
<span>  partition <span class="op">=</span> <span class="st">".part"</span>,</span>
<span>  background <span class="op">=</span> <span class="va">backg2</span>,</span>
<span>  thr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"max_sens_spec"</span>, <span class="st">"equal_sens_spec"</span>, <span class="st">"max_sorensen"</span><span class="op">)</span>,</span>
<span>  clamp <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  classes <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  pred_type <span class="op">=</span> <span class="st">"cloglog"</span>,</span>
<span>  regmult <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Formula used for model fitting:</span></span>
<span><span class="co">#&gt; ~aet + ppt_jja + pH + awc + depth + I(aet^2) + I(ppt_jja^2) + I(pH^2) + I(awc^2) + I(depth^2) + hinge(aet) + hinge(ppt_jja) + hinge(pH) + hinge(awc) + hinge(depth) + ppt_jja:aet + pH:aet + awc:aet + depth:aet + pH:ppt_jja + awc:ppt_jja + depth:ppt_jja + awc:pH + depth:pH + depth:awc + categorical(landform) - 1</span></span>
<span><span class="co">#&gt; Replica number: 1/1</span></span>
<span><span class="co">#&gt; Partition number: 1/5</span></span>
<span><span class="co">#&gt; Partition number: 2/5</span></span>
<span><span class="co">#&gt; Partition number: 3/5</span></span>
<span><span class="co">#&gt; Partition number: 4/5</span></span>
<span><span class="co">#&gt; Partition number: 5/5</span></span></code></pre></div>
<p>This function returns a list object with the following elements:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">max_t1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "model"       "predictors"  "performance" "data_ens"</span></span></code></pre></div>
<p>model: A “MaxEnt” class object. This object can be used for
predicting.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>max.print <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">max_t1</span><span class="op">$</span><span class="va">model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  glmnet::glmnet(x = mm, y = as.factor(p), family = "binomial",      weights = weights, lambda = 10^(seq(4, 0, length.out = 200)) *          sum(reg)/length(reg) * sum(p)/sum(weights), standardize = F,      penalty.factor = reg) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Df  %Dev  Lambda</span></span>
<span><span class="co">#&gt; 1    0  0.00 21.3700</span></span>
<span><span class="co">#&gt; 2    0  0.00 20.4100</span></span>
<span><span class="co">#&gt; 3    0  0.00 19.4800</span></span>
<span><span class="co">#&gt; 4    0  0.00 18.6000</span></span>
<span><span class="co">#&gt; 5    0  0.00 17.7600</span></span>
<span><span class="co">#&gt; 6    0  0.00 16.9600</span></span>
<span><span class="co">#&gt;  [ reached getOption("max.print") -- omitted 194 rows ]</span></span></code></pre></div>
<p>predictors: A tibble with quantitative (c column names) and
qualitative (f column names) variables use for modeling.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">max_t1</span><span class="op">$</span><span class="va">predictors</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 6</span></span></span>
<span><span class="co">#&gt;   c1    c2      c3    c4    c5    f       </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> aet   ppt_jja pH    awc   depth landform</span></span></code></pre></div>
<p>performance: The performance metric (see sdm_eval). Those metrics
that are threshold dependent are calculated based on the threshold
specified in the argument. We can see all the selected threshold
values.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">max_t1</span><span class="op">$</span><span class="va">performance</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 25</span></span></span>
<span><span class="co">#&gt;   model threshold      thr_value n_presences n_absences TPR_mean TPR_sd TNR_mean</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> max   equal_sens_sp…     0.573         700        700    0.674 0.016<span style="text-decoration: underline;">4</span>    0.674</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> max   max_sens_spec      0.416         700        700    0.909 0.026<span style="text-decoration: underline;">0</span>    0.52 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> max   max_sorensen       0.335         700        700    0.95  0.010<span style="text-decoration: underline;">1</span>    0.469</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 17 more variables: TNR_sd &lt;dbl&gt;, SORENSEN_mean &lt;dbl&gt;, SORENSEN_sd &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   JACCARD_mean &lt;dbl&gt;, JACCARD_sd &lt;dbl&gt;, FPB_mean &lt;dbl&gt;, FPB_sd &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   OR_mean &lt;dbl&gt;, OR_sd &lt;dbl&gt;, TSS_mean &lt;dbl&gt;, TSS_sd &lt;dbl&gt;, AUC_mean &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   AUC_sd &lt;dbl&gt;, BOYCE_mean &lt;dbl&gt;, BOYCE_sd &lt;dbl&gt;, IMAE_mean &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   IMAE_sd &lt;dbl&gt;</span></span></span></code></pre></div>
<p>Predicted suitability for each test partition (row) based on the best
model. This database is used in fit_ensemble.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">max_t1</span><span class="op">$</span><span class="va">data_ens</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,400 × 5</span></span></span>
<span><span class="co">#&gt;    rnames replicates part  pr_ab   pred</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 8      .part      1         0 0.600 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 11     .part      1         0 0.237 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 13     .part      1         0 0.048<span style="text-decoration: underline;">3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 20     .part      1         0 0.115 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 32     .part      1         0 0.716 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 33     .part      1         0 0.043<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 48     .part      1         0 0.143 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 55     .part      1         0 0.726 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 65     .part      1         0 0.850 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 75     .part      1         0 0.308 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1,390 more rows</span></span></span></code></pre></div>
<p>II- Random forest models with exploration of hyper-parameters.</p>
<p>First, we create a data.frame that provides hyper-parameters values
to be tested. It Is recommended to generate this data.frame.
Hyper-parameter needed for tuning is ‘mtry’. The maximum mtry must be
equal to total number of predictors.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tune_grid</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>    mtry <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">7</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    ntree <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">500</span>, <span class="fl">700</span>, <span class="fl">900</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>We use the same data object abies2, with the same k-fold partition
method:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rf_t</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/tune_raf.html">tune_raf</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">abies2</span>,</span>
<span>    response <span class="op">=</span> <span class="st">"pr_ab"</span>,</span>
<span>    predictors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"aet"</span>, <span class="st">"cwd"</span>, <span class="st">"tmin"</span>, <span class="st">"ppt_djf"</span>,</span>
<span>      <span class="st">"ppt_jja"</span>, <span class="st">"pH"</span>, <span class="st">"awc"</span>, <span class="st">"depth"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    predictors_f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"landform"</span><span class="op">)</span>,</span>
<span>    partition <span class="op">=</span> <span class="st">".part"</span>,</span>
<span>    grid <span class="op">=</span> <span class="va">tune_grid</span>,</span>
<span>    thr <span class="op">=</span> <span class="st">"max_sens_spec"</span>,</span>
<span>    metric <span class="op">=</span> <span class="st">"TSS"</span>,</span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Formula used for model fitting:</span></span>
<span><span class="co">#&gt; pr_ab ~ aet + cwd + tmin + ppt_djf + ppt_jja + pH + awc + depth + landform</span></span>
<span><span class="co">#&gt; Tuning model...</span></span>
<span><span class="co">#&gt; Replica number: 1/1</span></span>
<span><span class="co">#&gt; Formula used for model fitting:</span></span>
<span><span class="co">#&gt; pr_ab ~ aet + cwd + tmin + ppt_djf + ppt_jja + pH + awc + depth + landform</span></span>
<span><span class="co">#&gt; Replica number: 1/1</span></span>
<span><span class="co">#&gt; Partition number: 1/5</span></span>
<span><span class="co">#&gt; Partition number: 2/5</span></span>
<span><span class="co">#&gt; Partition number: 3/5</span></span>
<span><span class="co">#&gt; Partition number: 4/5</span></span>
<span><span class="co">#&gt; Partition number: 5/5</span></span></code></pre></div>
<p>Let’s see what the output object contains. This function returns a
list object with the following elements:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">rf_t</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "model"             "predictors"        "performance"      </span></span>
<span><span class="co">#&gt; [4] "hyper_performance" "data_ens"</span></span></code></pre></div>
<p>model: A “randomForest” class object. This object can be used to see
the formula details, a basic summary o fthe model, and for
predicting.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rf_t</span><span class="op">$</span><span class="va">model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt;  randomForest(formula = formula1, data = data, mtry = mtry, ntree = 500,      importance = TRUE, ) </span></span>
<span><span class="co">#&gt;                Type of random forest: classification</span></span>
<span><span class="co">#&gt;                      Number of trees: 500</span></span>
<span><span class="co">#&gt; No. of variables tried at each split: 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         OOB estimate of  error rate: 10.93%</span></span>
<span><span class="co">#&gt; Confusion matrix:</span></span>
<span><span class="co">#&gt;     0   1 class.error</span></span>
<span><span class="co">#&gt; 0 606  94  0.13428571</span></span>
<span><span class="co">#&gt; 1  59 641  0.08428571</span></span></code></pre></div>
<p>predictors: A tibble with quantitative (c column names) and
qualitative (f column names) variables use for modeling.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rf_t</span><span class="op">$</span><span class="va">predictors</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 9</span></span></span>
<span><span class="co">#&gt;   c1    c2    c3    c4      c5      c6    c7    c8    f       </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> aet   cwd   tmin  ppt_djf ppt_jja pH    awc   depth landform</span></span></code></pre></div>
<p>performance: The performance metric (see sdm_eval). Those metrics
that are threshold dependent are calculated based on the threshold
specified in the argument. We can see all the selected threshold
values.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rf_t</span><span class="op">$</span><span class="va">performance</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 27</span></span></span>
<span><span class="co">#&gt;    mtry ntree model threshold   thr_value n_presences n_absences TPR_mean TPR_sd</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     2   300 raf   max_sens_s…      0.53         700        700    0.913 0.038<span style="text-decoration: underline;">3</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 18 more variables: TNR_mean &lt;dbl&gt;, TNR_sd &lt;dbl&gt;, SORENSEN_mean &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   SORENSEN_sd &lt;dbl&gt;, JACCARD_mean &lt;dbl&gt;, JACCARD_sd &lt;dbl&gt;, FPB_mean &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   FPB_sd &lt;dbl&gt;, OR_mean &lt;dbl&gt;, OR_sd &lt;dbl&gt;, TSS_mean &lt;dbl&gt;, TSS_sd &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   AUC_mean &lt;dbl&gt;, AUC_sd &lt;dbl&gt;, BOYCE_mean &lt;dbl&gt;, BOYCE_sd &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   IMAE_mean &lt;dbl&gt;, IMAE_sd &lt;dbl&gt;</span></span></span></code></pre></div>
<p>Predicted suitability for each test partition (row) based on the best
model. This database is used in fit_ensemble.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rf_t</span><span class="op">$</span><span class="va">data_ens</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,400 × 5</span></span></span>
<span><span class="co">#&gt;    rnames replicates part  pr_ab  pred</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 8      .part      1     0     0.156</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 11     .part      1     0     0.152</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 13     .part      1     0     0.01 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 20     .part      1     0     0.476</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 32     .part      1     0     0.126</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 33     .part      1     0     0.078</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 48     .part      1     0     0.01 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 55     .part      1     0     0.148</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 65     .part      1     0     0.444</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 75     .part      1     0     0.086</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1,390 more rows</span></span></span></code></pre></div>
<p>These model objects can be used in flexsdm::fit_ensemble().</p>
</div>
<div class="section level3">
<h3 id="model-ensemble">2. Model Ensemble<a class="anchor" aria-label="anchor" href="#model-ensemble"></a>
</h3>
<p>In this example we fit and validate and ensemble model using the two
model objects that were just created.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit and validate ensemble model</span></span>
<span><span class="va">an_ensemble</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_ensemble.html">fit_ensemble</a></span><span class="op">(</span></span>
<span>  models <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">max_t1</span>, <span class="va">rf_t</span><span class="op">)</span>,</span>
<span>  ens_method <span class="op">=</span> <span class="st">"meansup"</span>,</span>
<span>  thr <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  thr_model <span class="op">=</span> <span class="st">"max_sens_spec"</span>,</span>
<span>  metric <span class="op">=</span> <span class="st">"TSS"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Outputs</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">an_ensemble</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "models"      "thr_metric"  "predictors"  "performance"</span></span>
<span></span>
<span><span class="va">an_ensemble</span><span class="op">$</span><span class="va">thr_metric</span></span>
<span><span class="co">#&gt; [1] "max_sens_spec" "TSS_mean"</span></span>
<span><span class="va">an_ensemble</span><span class="op">$</span><span class="va">predictors</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 9</span></span></span>
<span><span class="co">#&gt;   c1    c2      c3    c4      c5      f        c6    c7    c8   </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> aet   ppt_jja pH    awc     depth   landform <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> aet   cwd     tmin  ppt_djf ppt_jja landform pH    awc   depth</span></span>
<span><span class="va">an_ensemble</span><span class="op">$</span><span class="va">performance</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 × 25</span></span></span>
<span><span class="co">#&gt;   model   threshold   thr_value n_presences n_absences TPR_mean  TPR_sd TNR_mean</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> meansup equal_sens…     0.58          700        700    0.876 0.025<span style="text-decoration: underline;">1</span>     0.876</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> meansup lpt             0.028         700        700    1     0          0.421</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> meansup max_fpb         0.48          700        700    0.933 0.031<span style="text-decoration: underline;">0</span>     0.843</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> meansup max_jaccard     0.48          700        700    0.933 0.031<span style="text-decoration: underline;">0</span>     0.843</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> meansup max_sens_s…     0.48          700        700    0.91  0.034<span style="text-decoration: underline;">5</span>     0.87 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> meansup max_sorens…     0.48          700        700    0.933 0.031<span style="text-decoration: underline;">0</span>     0.843</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> meansup sensitivity     0.534         700        700    0.897 0.003<span style="text-decoration: underline;">91</span>    0.857</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 17 more variables: TNR_sd &lt;dbl&gt;, SORENSEN_mean &lt;dbl&gt;, SORENSEN_sd &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   JACCARD_mean &lt;dbl&gt;, JACCARD_sd &lt;dbl&gt;, FPB_mean &lt;dbl&gt;, FPB_sd &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   OR_mean &lt;dbl&gt;, OR_sd &lt;dbl&gt;, TSS_mean &lt;dbl&gt;, TSS_sd &lt;dbl&gt;, AUC_mean &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   AUC_sd &lt;dbl&gt;, BOYCE_mean &lt;dbl&gt;, BOYCE_sd &lt;dbl&gt;, IMAE_mean &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   IMAE_sd &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fit-and-validate-models-with-ensemble-of-small-model-approach">3. Fit and validate models with Ensemble of Small Model
approach<a class="anchor" aria-label="anchor" href="#fit-and-validate-models-with-ensemble-of-small-model-approach"></a>
</h3>
<p>This method consists of creating bivariate models with all pair-wise
combinations of predictors and perform an ensemble based on the average
of suitability weighted by Somers’ D metric (D = 2 x (AUC -0.5)). ESM is
recommended for modeling species with very few occurrences. This
function does not allow categorical variables because the use of these
types of variables could be problematic when applied to species with few
occurrences. For more detail see Breiner et al. (2015, 2018)</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"abies"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a smaller subset of occurrences</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">abies2</span> <span class="op">&lt;-</span> <span class="va">abies</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rspatial.github.io/terra/reference/na.omit.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">pr_ab</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_sample</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>We can use different methods in the flexsdm::part_random function
according to our data. See <a href="https://sjevelazco.github.io/flexsdm/reference/part_random.html">part_random</a>
for more details.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using k-fold partition method for model cross validation</span></span>
<span><span class="va">abies2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/part_random.html">part_random</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">abies2</span>,</span>
<span>  pr_ab <span class="op">=</span> <span class="st">"pr_ab"</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"kfold"</span>, folds <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">abies2</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 20 × 14</span></span></span>
<span><span class="co">#&gt;       id pr_ab        x        y   aet   cwd   tmin ppt_djf ppt_jja    pH    awc</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> <span style="text-decoration: underline;">12</span>040     0 -<span style="color: #BB0000; text-decoration: underline;">308</span><span style="color: #BB0000;">909.</span>  <span style="text-decoration: underline;">384</span>248.  573.  332.  4.84     521.   48.8   5.63 0.108 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> <span style="text-decoration: underline;">10</span>361     0 -<span style="color: #BB0000; text-decoration: underline;">254</span><span style="color: #BB0000;">286.</span>  <span style="text-decoration: underline;">417</span>158.  260.  469.  2.93     151.   15.1   6.20 0.095<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  <span style="text-decoration: underline;">9</span>402     0 -<span style="color: #BB0000; text-decoration: underline;">286</span><span style="color: #BB0000;">979.</span>  <span style="text-decoration: underline;">386</span>206.  587.  376.  6.45     333.   15.7   5.5  0.160 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  <span style="text-decoration: underline;">9</span>815     0 -<span style="color: #BB0000; text-decoration: underline;">291</span><span style="color: #BB0000;">849.</span>  <span style="text-decoration: underline;">445</span>595.  443.  455.  4.39     332.   19.1   6    0.070<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> <span style="text-decoration: underline;">10</span>524     0 -<span style="color: #BB0000; text-decoration: underline;">256</span><span style="color: #BB0000;">658.</span>  <span style="text-decoration: underline;">184</span>438.  355.  568.  5.87     303.   10.6   5.20 0.080<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  <span style="text-decoration: underline;">8</span>860     0  <span style="text-decoration: underline;">121</span>343. -<span style="color: #BB0000; text-decoration: underline;">164</span><span style="color: #BB0000;">170.</span>  354.  733.  3.97     182.    9.83  0    0     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  <span style="text-decoration: underline;">6</span>431     0  <span style="text-decoration: underline;">107</span>903. -<span style="color: #BB0000; text-decoration: underline;">122</span><span style="color: #BB0000;">968.</span>  461.  578.  4.87     161.    7.66  5.90 0.090<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> <span style="text-decoration: underline;">11</span>730     0 -<span style="color: #BB0000; text-decoration: underline;">333</span><span style="color: #BB0000;">903.</span>  <span style="text-decoration: underline;">431</span>238.  561.  364.  6.73     387.   25.2   5.80 0.130 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>   808     0 -<span style="color: #BB0000; text-decoration: underline;">150</span><span style="color: #BB0000;">163.</span>  <span style="text-decoration: underline;">357</span>180.  339.  564.  2.64     220.   15.3   6.40 0.100 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> <span style="text-decoration: underline;">11</span>054     0 -<span style="color: #BB0000; text-decoration: underline;">293</span><span style="color: #BB0000;">663.</span>  <span style="text-decoration: underline;">340</span>981.  477.  396.  3.89     332.   26.4   4.60 0.063<span style="text-decoration: underline;">4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>  <span style="text-decoration: underline;">2</span>960     1  -<span style="color: #BB0000; text-decoration: underline;">49</span><span style="color: #BB0000;">273.</span>  <span style="text-decoration: underline;">181</span>752.  512.  275.  0.920    319.   17.3   5.92 0.090<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>  <span style="text-decoration: underline;">3</span>065     1  <span style="text-decoration: underline;">126</span>907. -<span style="color: #BB0000; text-decoration: underline;">198</span><span style="color: #BB0000;">892.</span>  322.  544.  0.700    203.   10.6   5.60 0.110 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>  <span style="text-decoration: underline;">5</span>527     1  <span style="text-decoration: underline;">116</span>751. -<span style="color: #BB0000; text-decoration: underline;">181</span><span style="color: #BB0000;">089.</span>  261.  537.  0.363    178.    7.43  0    0     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>  <span style="text-decoration: underline;">4</span>035     1  -<span style="color: #BB0000; text-decoration: underline;">31</span><span style="color: #BB0000;">777.</span>  <span style="text-decoration: underline;">115</span>940.  394.  440.  2.07     298.   11.2   6.01 0.076<span style="text-decoration: underline;">9</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>  <span style="text-decoration: underline;">4</span>081     1   -<span style="color: #BB0000; text-decoration: underline;">5</span><span style="color: #BB0000;">158.</span>   <span style="text-decoration: underline;">90</span>159.  301.  502.  0.703    203.   14.6   6.11 0.063<span style="text-decoration: underline;">3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span>  <span style="text-decoration: underline;">3</span>087     1  <span style="text-decoration: underline;">102</span>151. -<span style="color: #BB0000; text-decoration: underline;">143</span><span style="color: #BB0000;">976.</span>  299.  425. -<span style="color: #BB0000;">2.08</span>     205.   13.4   3.88 0.110 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span>  <span style="text-decoration: underline;">3</span>495     1  -<span style="color: #BB0000; text-decoration: underline;">19</span><span style="color: #BB0000;">586.</span>   <span style="text-decoration: underline;">89</span>803.  438.  419.  2.13     189.   15.2   6.19 0.095<span style="text-decoration: underline;">9</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span>  <span style="text-decoration: underline;">4</span>441     1   <span style="text-decoration: underline;">49</span>405.  -<span style="color: #BB0000; text-decoration: underline;">60</span><span style="color: #BB0000;">502.</span>  362.  582.  2.42     218.    7.84  5.64 0.078<span style="text-decoration: underline;">6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span>   301     1 -<span style="color: #BB0000; text-decoration: underline;">132</span><span style="color: #BB0000;">516.</span>  <span style="text-decoration: underline;">270</span>845.  367.  196. -<span style="color: #BB0000;">2.56</span>     422.   26.3   6.70 0.030<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span>  <span style="text-decoration: underline;">3</span>162     1   <span style="text-decoration: underline;">59</span>905.  -<span style="color: #BB0000; text-decoration: underline;">53</span><span style="color: #BB0000;">634.</span>  319.  626.  1.99     212.    4.50  4.51 0.039<span style="text-decoration: underline;">6</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 3 more variables: depth &lt;dbl&gt;, landform &lt;fct&gt;, .part &lt;int&gt;</span></span></span></code></pre></div>
<p>This function constructs Generalized Additive Models using the
Ensembles of Small Models (ESM) approach (Breiner et al., 2015,
2018).</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We set the model without threshold specification and with the kfold created above</span></span>
<span><span class="va">esm_gam_t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/esm_gam.html">esm_gam</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">abies2</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"pr_ab"</span>,</span>
<span>  predictors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"aet"</span>, <span class="st">"cwd"</span>, <span class="st">"tmin"</span>, <span class="st">"ppt_djf"</span>, <span class="st">"ppt_jja"</span>, <span class="st">"pH"</span>, <span class="st">"awc"</span>, <span class="st">"depth"</span><span class="op">)</span>,</span>
<span>  partition <span class="op">=</span> <span class="st">".part"</span>,</span>
<span>  thr <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model has more coefficients than data used for training it. Try to reduce k</span></span></code></pre></div>
<p>This function returns a list object with the following elements:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">esm_gam_t1</span><span class="op">)</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>esm_model: A list with “GAM” class object for each bivariate model.
This object can be used for predicting using the ESM approachwith
sdm_predict function.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>max.print <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># If you don't want to see printed all the output</span></span>
<span><span class="va">esm_gam_t1</span><span class="op">$</span><span class="va">esm_model</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>predictors: A tibble with variables use for modeling.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">esm_gam_t1</span><span class="op">$</span><span class="va">predictors</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>performance: Performance metric (see sdm_eval). Those threshold
dependent metrics are calculated based on the threshold specified in the
argument.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">esm_gam_t1</span><span class="op">$</span><span class="va">performance</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>Now, we test the rep_kfold partition method. In this method ‘folds’
refers to the number of partitions for data partitioning and ‘replicate’
refers to the number of replicates. Both assume values &gt;=1.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Remove the previous k-fold partition</span></span>
<span><span class="va">abies2</span> <span class="op">&lt;-</span> <span class="va">abies2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"."</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Test with rep_kfold partition using 3 folds and 5 replicates</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">abies2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/part_random.html">part_random</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">abies2</span>,</span>
<span>  pr_ab <span class="op">=</span> <span class="st">"pr_ab"</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"rep_kfold"</span>, folds <span class="op">=</span> <span class="fl">3</span>, replicates <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">abies2</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 20 × 18</span></span></span>
<span><span class="co">#&gt;       id pr_ab        x        y   aet   cwd   tmin ppt_djf ppt_jja    pH    awc</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> <span style="text-decoration: underline;">12</span>040     0 -<span style="color: #BB0000; text-decoration: underline;">308</span><span style="color: #BB0000;">909.</span>  <span style="text-decoration: underline;">384</span>248.  573.  332.  4.84     521.   48.8   5.63 0.108 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> <span style="text-decoration: underline;">10</span>361     0 -<span style="color: #BB0000; text-decoration: underline;">254</span><span style="color: #BB0000;">286.</span>  <span style="text-decoration: underline;">417</span>158.  260.  469.  2.93     151.   15.1   6.20 0.095<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  <span style="text-decoration: underline;">9</span>402     0 -<span style="color: #BB0000; text-decoration: underline;">286</span><span style="color: #BB0000;">979.</span>  <span style="text-decoration: underline;">386</span>206.  587.  376.  6.45     333.   15.7   5.5  0.160 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  <span style="text-decoration: underline;">9</span>815     0 -<span style="color: #BB0000; text-decoration: underline;">291</span><span style="color: #BB0000;">849.</span>  <span style="text-decoration: underline;">445</span>595.  443.  455.  4.39     332.   19.1   6    0.070<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> <span style="text-decoration: underline;">10</span>524     0 -<span style="color: #BB0000; text-decoration: underline;">256</span><span style="color: #BB0000;">658.</span>  <span style="text-decoration: underline;">184</span>438.  355.  568.  5.87     303.   10.6   5.20 0.080<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  <span style="text-decoration: underline;">8</span>860     0  <span style="text-decoration: underline;">121</span>343. -<span style="color: #BB0000; text-decoration: underline;">164</span><span style="color: #BB0000;">170.</span>  354.  733.  3.97     182.    9.83  0    0     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  <span style="text-decoration: underline;">6</span>431     0  <span style="text-decoration: underline;">107</span>903. -<span style="color: #BB0000; text-decoration: underline;">122</span><span style="color: #BB0000;">968.</span>  461.  578.  4.87     161.    7.66  5.90 0.090<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> <span style="text-decoration: underline;">11</span>730     0 -<span style="color: #BB0000; text-decoration: underline;">333</span><span style="color: #BB0000;">903.</span>  <span style="text-decoration: underline;">431</span>238.  561.  364.  6.73     387.   25.2   5.80 0.130 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>   808     0 -<span style="color: #BB0000; text-decoration: underline;">150</span><span style="color: #BB0000;">163.</span>  <span style="text-decoration: underline;">357</span>180.  339.  564.  2.64     220.   15.3   6.40 0.100 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> <span style="text-decoration: underline;">11</span>054     0 -<span style="color: #BB0000; text-decoration: underline;">293</span><span style="color: #BB0000;">663.</span>  <span style="text-decoration: underline;">340</span>981.  477.  396.  3.89     332.   26.4   4.60 0.063<span style="text-decoration: underline;">4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>  <span style="text-decoration: underline;">2</span>960     1  -<span style="color: #BB0000; text-decoration: underline;">49</span><span style="color: #BB0000;">273.</span>  <span style="text-decoration: underline;">181</span>752.  512.  275.  0.920    319.   17.3   5.92 0.090<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>  <span style="text-decoration: underline;">3</span>065     1  <span style="text-decoration: underline;">126</span>907. -<span style="color: #BB0000; text-decoration: underline;">198</span><span style="color: #BB0000;">892.</span>  322.  544.  0.700    203.   10.6   5.60 0.110 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>  <span style="text-decoration: underline;">5</span>527     1  <span style="text-decoration: underline;">116</span>751. -<span style="color: #BB0000; text-decoration: underline;">181</span><span style="color: #BB0000;">089.</span>  261.  537.  0.363    178.    7.43  0    0     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>  <span style="text-decoration: underline;">4</span>035     1  -<span style="color: #BB0000; text-decoration: underline;">31</span><span style="color: #BB0000;">777.</span>  <span style="text-decoration: underline;">115</span>940.  394.  440.  2.07     298.   11.2   6.01 0.076<span style="text-decoration: underline;">9</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>  <span style="text-decoration: underline;">4</span>081     1   -<span style="color: #BB0000; text-decoration: underline;">5</span><span style="color: #BB0000;">158.</span>   <span style="text-decoration: underline;">90</span>159.  301.  502.  0.703    203.   14.6   6.11 0.063<span style="text-decoration: underline;">3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span>  <span style="text-decoration: underline;">3</span>087     1  <span style="text-decoration: underline;">102</span>151. -<span style="color: #BB0000; text-decoration: underline;">143</span><span style="color: #BB0000;">976.</span>  299.  425. -<span style="color: #BB0000;">2.08</span>     205.   13.4   3.88 0.110 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span>  <span style="text-decoration: underline;">3</span>495     1  -<span style="color: #BB0000; text-decoration: underline;">19</span><span style="color: #BB0000;">586.</span>   <span style="text-decoration: underline;">89</span>803.  438.  419.  2.13     189.   15.2   6.19 0.095<span style="text-decoration: underline;">9</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span>  <span style="text-decoration: underline;">4</span>441     1   <span style="text-decoration: underline;">49</span>405.  -<span style="color: #BB0000; text-decoration: underline;">60</span><span style="color: #BB0000;">502.</span>  362.  582.  2.42     218.    7.84  5.64 0.078<span style="text-decoration: underline;">6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span>   301     1 -<span style="color: #BB0000; text-decoration: underline;">132</span><span style="color: #BB0000;">516.</span>  <span style="text-decoration: underline;">270</span>845.  367.  196. -<span style="color: #BB0000;">2.56</span>     422.   26.3   6.70 0.030<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span>  <span style="text-decoration: underline;">3</span>162     1   <span style="text-decoration: underline;">59</span>905.  -<span style="color: #BB0000; text-decoration: underline;">53</span><span style="color: #BB0000;">634.</span>  319.  626.  1.99     212.    4.50  4.51 0.039<span style="text-decoration: underline;">6</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 7 more variables: depth &lt;dbl&gt;, landform &lt;fct&gt;, .part1 &lt;int&gt;, .part2 &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   .part3 &lt;int&gt;, .part4 &lt;int&gt;, .part5 &lt;int&gt;</span></span></span></code></pre></div>
<p>We use the new rep_kfold partition in the gam model</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">esm_gam_t2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/esm_gam.html">esm_gam</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">abies2</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"pr_ab"</span>,</span>
<span>  predictors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"aet"</span>, <span class="st">"cwd"</span>, <span class="st">"tmin"</span>, <span class="st">"ppt_djf"</span>, <span class="st">"ppt_jja"</span>, <span class="st">"pH"</span>, <span class="st">"awc"</span>, <span class="st">"depth"</span><span class="op">)</span>,</span>
<span>  partition <span class="op">=</span> <span class="st">".part"</span>,</span>
<span>  thr <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model has more coefficients than data used for training it. Try to reduce k</span></span></code></pre></div>
<p>Test with random bootstrap partitioning. In method ‘replicate’ refers
to the number of replicates (assumes a value &gt;=1), ‘proportion’
refers to the proportion of occurrences used for model fitting (assumes
a value &gt;0 and &lt;=1). With this method we can configure the
proportion of training and testing data according to the species
occurrences. In this example, proportion=‘0.7’ indicates that 70% of
data will be used for model training, while 30% will be used for model
testing. For this method, the function will return .partX columns with
“train” or “test” words as the entries.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Remove the previous k-fold partition</span></span>
<span><span class="va">abies2</span> <span class="op">&lt;-</span> <span class="va">abies2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"."</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Test with bootstrap partition using 10 replicates</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">abies2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/part_random.html">part_random</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">abies2</span>,</span>
<span>  pr_ab <span class="op">=</span> <span class="st">"pr_ab"</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"boot"</span>, replicates <span class="op">=</span> <span class="fl">10</span>, proportion <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">abies2</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 20 × 23</span></span></span>
<span><span class="co">#&gt;       id pr_ab        x        y   aet   cwd   tmin ppt_djf ppt_jja    pH    awc</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> <span style="text-decoration: underline;">12</span>040     0 -<span style="color: #BB0000; text-decoration: underline;">308</span><span style="color: #BB0000;">909.</span>  <span style="text-decoration: underline;">384</span>248.  573.  332.  4.84     521.   48.8   5.63 0.108 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> <span style="text-decoration: underline;">10</span>361     0 -<span style="color: #BB0000; text-decoration: underline;">254</span><span style="color: #BB0000;">286.</span>  <span style="text-decoration: underline;">417</span>158.  260.  469.  2.93     151.   15.1   6.20 0.095<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>  <span style="text-decoration: underline;">9</span>402     0 -<span style="color: #BB0000; text-decoration: underline;">286</span><span style="color: #BB0000;">979.</span>  <span style="text-decoration: underline;">386</span>206.  587.  376.  6.45     333.   15.7   5.5  0.160 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>  <span style="text-decoration: underline;">9</span>815     0 -<span style="color: #BB0000; text-decoration: underline;">291</span><span style="color: #BB0000;">849.</span>  <span style="text-decoration: underline;">445</span>595.  443.  455.  4.39     332.   19.1   6    0.070<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> <span style="text-decoration: underline;">10</span>524     0 -<span style="color: #BB0000; text-decoration: underline;">256</span><span style="color: #BB0000;">658.</span>  <span style="text-decoration: underline;">184</span>438.  355.  568.  5.87     303.   10.6   5.20 0.080<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>  <span style="text-decoration: underline;">8</span>860     0  <span style="text-decoration: underline;">121</span>343. -<span style="color: #BB0000; text-decoration: underline;">164</span><span style="color: #BB0000;">170.</span>  354.  733.  3.97     182.    9.83  0    0     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>  <span style="text-decoration: underline;">6</span>431     0  <span style="text-decoration: underline;">107</span>903. -<span style="color: #BB0000; text-decoration: underline;">122</span><span style="color: #BB0000;">968.</span>  461.  578.  4.87     161.    7.66  5.90 0.090<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> <span style="text-decoration: underline;">11</span>730     0 -<span style="color: #BB0000; text-decoration: underline;">333</span><span style="color: #BB0000;">903.</span>  <span style="text-decoration: underline;">431</span>238.  561.  364.  6.73     387.   25.2   5.80 0.130 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>   808     0 -<span style="color: #BB0000; text-decoration: underline;">150</span><span style="color: #BB0000;">163.</span>  <span style="text-decoration: underline;">357</span>180.  339.  564.  2.64     220.   15.3   6.40 0.100 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> <span style="text-decoration: underline;">11</span>054     0 -<span style="color: #BB0000; text-decoration: underline;">293</span><span style="color: #BB0000;">663.</span>  <span style="text-decoration: underline;">340</span>981.  477.  396.  3.89     332.   26.4   4.60 0.063<span style="text-decoration: underline;">4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>  <span style="text-decoration: underline;">2</span>960     1  -<span style="color: #BB0000; text-decoration: underline;">49</span><span style="color: #BB0000;">273.</span>  <span style="text-decoration: underline;">181</span>752.  512.  275.  0.920    319.   17.3   5.92 0.090<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>  <span style="text-decoration: underline;">3</span>065     1  <span style="text-decoration: underline;">126</span>907. -<span style="color: #BB0000; text-decoration: underline;">198</span><span style="color: #BB0000;">892.</span>  322.  544.  0.700    203.   10.6   5.60 0.110 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>  <span style="text-decoration: underline;">5</span>527     1  <span style="text-decoration: underline;">116</span>751. -<span style="color: #BB0000; text-decoration: underline;">181</span><span style="color: #BB0000;">089.</span>  261.  537.  0.363    178.    7.43  0    0     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>  <span style="text-decoration: underline;">4</span>035     1  -<span style="color: #BB0000; text-decoration: underline;">31</span><span style="color: #BB0000;">777.</span>  <span style="text-decoration: underline;">115</span>940.  394.  440.  2.07     298.   11.2   6.01 0.076<span style="text-decoration: underline;">9</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>  <span style="text-decoration: underline;">4</span>081     1   -<span style="color: #BB0000; text-decoration: underline;">5</span><span style="color: #BB0000;">158.</span>   <span style="text-decoration: underline;">90</span>159.  301.  502.  0.703    203.   14.6   6.11 0.063<span style="text-decoration: underline;">3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span>  <span style="text-decoration: underline;">3</span>087     1  <span style="text-decoration: underline;">102</span>151. -<span style="color: #BB0000; text-decoration: underline;">143</span><span style="color: #BB0000;">976.</span>  299.  425. -<span style="color: #BB0000;">2.08</span>     205.   13.4   3.88 0.110 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span>  <span style="text-decoration: underline;">3</span>495     1  -<span style="color: #BB0000; text-decoration: underline;">19</span><span style="color: #BB0000;">586.</span>   <span style="text-decoration: underline;">89</span>803.  438.  419.  2.13     189.   15.2   6.19 0.095<span style="text-decoration: underline;">9</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span>  <span style="text-decoration: underline;">4</span>441     1   <span style="text-decoration: underline;">49</span>405.  -<span style="color: #BB0000; text-decoration: underline;">60</span><span style="color: #BB0000;">502.</span>  362.  582.  2.42     218.    7.84  5.64 0.078<span style="text-decoration: underline;">6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span>   301     1 -<span style="color: #BB0000; text-decoration: underline;">132</span><span style="color: #BB0000;">516.</span>  <span style="text-decoration: underline;">270</span>845.  367.  196. -<span style="color: #BB0000;">2.56</span>     422.   26.3   6.70 0.030<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span>  <span style="text-decoration: underline;">3</span>162     1   <span style="text-decoration: underline;">59</span>905.  -<span style="color: #BB0000; text-decoration: underline;">53</span><span style="color: #BB0000;">634.</span>  319.  626.  1.99     212.    4.50  4.51 0.039<span style="text-decoration: underline;">6</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 12 more variables: depth &lt;dbl&gt;, landform &lt;fct&gt;, .part1 &lt;chr&gt;, .part2 &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   .part3 &lt;chr&gt;, .part4 &lt;chr&gt;, .part5 &lt;chr&gt;, .part6 &lt;chr&gt;, .part7 &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   .part8 &lt;chr&gt;, .part9 &lt;chr&gt;, .part10 &lt;chr&gt;</span></span></span></code></pre></div>
<p>Use the new rep_kfold partition in the gam model</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">esm_gam_t3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/esm_gam.html">esm_gam</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">abies2</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"pr_ab"</span>,</span>
<span>  predictors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"aet"</span>, <span class="st">"cwd"</span>, <span class="st">"tmin"</span>, <span class="st">"ppt_djf"</span>, <span class="st">"ppt_jja"</span>, <span class="st">"pH"</span>, <span class="st">"awc"</span>, <span class="st">"depth"</span><span class="op">)</span>,</span>
<span>  partition <span class="op">=</span> <span class="st">".part"</span>,</span>
<span>  thr <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model has more coefficients than data used for training it. Try to reduce k</span></span></code></pre></div>
<p>#=========#=========#=========#=========#=========#=========#=========#</p>
<p><strong>Vignette still under construction and changes</strong></p>
<p>#=========#=========#=========#=========#=========#=========#=========#</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Santiago J.E. Velazco, Brooke Rose, André F.A. Andrade, Ignacio Minoli, Janet Franklin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
