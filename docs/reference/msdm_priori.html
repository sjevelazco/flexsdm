<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create spatial predictor variables to reduce overprediction of species distribution models — msdm_priori • flexsdm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create spatial predictor variables to reduce overprediction of species distribution models — msdm_priori"><meta name="description" content="This function creates geographical predictor variables that, together with
environmental variables, can be used to construct constrained species distribution models."><meta property="og:description" content="This function creates geographical predictor variables that, together with
environmental variables, can be used to construct constrained species distribution models."><meta name="google-site-verification" content="gcou8tqRTwNjZ_Mf1kbFgAzzUcY3OF-JB2sPRPTA56I"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">flexsdm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Home"><span class="fa fa-home"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/v01_pre_modeling.html">1. Overview of Pre-modeling functions</a></li>
    <li><a class="dropdown-item" href="../articles/v02_modeling.html">2. Overview of Modeling functions</a></li>
    <li><a class="dropdown-item" href="../articles/v03_post_modeling.html">3. Overview of Post-modeling functions</a></li>
    <li><a class="dropdown-item" href="../articles/v04_Red_fir_example.html">4. An example with Red Fir</a></li>
    <li><a class="dropdown-item" href="../articles/v05_Rare_species_example.html">5. Modeling a rare species</a></li>
    <li><a class="dropdown-item" href="../articles/v06_Extrapolation_example.html">6. Tools to explore extrapolation in SDMs</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/pkg_citation.html">Citations</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/pkg_citation.html">Citations</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
<li class="nav-item"><a class="nav-link" href="https://sjevelazco.github.io/flexsdm" aria-label="GitHub">GitHub</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sjevelazco/flexsdm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Create spatial predictor variables to reduce overprediction of species distribution models</h1>
      <small class="dont-index">Source: <a href="https://github.com/sjevelazco/flexsdm/blob/HEAD/R/msdm_priori.R" class="external-link"><code>R/msdm_priori.R</code></a></small>
      <div class="d-none name"><code>msdm_priori.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function creates geographical predictor variables that, together with
environmental variables, can be used to construct constrained species distribution models.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">msdm_priori</span><span class="op">(</span><span class="va">data</span>, <span class="va">x</span>, <span class="va">y</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"xy"</span>, <span class="st">"min"</span>, <span class="st">"cml"</span>, <span class="st">"ker"</span><span class="op">)</span>, <span class="va">env_layer</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>tibble or data.frame. A database with geographical coordinates of species presences.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>character. Column name with spatial x coordinates.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>character. Column name with spatial y coordinates.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>character. A character string indicating which MSDM method will be used. The
following methods are available: 'xy', 'min', 'cml', and 'ker'. Usage method = 'cml'</p></dd>


<dt id="arg-env-layer">env_layer<a class="anchor" aria-label="anchor" href="#arg-env-layer"></a></dt>
<dd><p>A raster layer used to construct species distribution models. This object will
be used to create constraining variables with the same resolution, extent, and pattern of empty
cells as the environmental variables. It is advisable to use a raster of an environmental layer
that will be used to create the species distribution models to avoid mismatch (e.g. resolution,
extent, cells with NA) between environmental and constraining variables.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>This function returns a SpatRaster object. Such raster/s have to be used together with
environmental variables to construct species distribution models.
The 'xy' approach creates a single pair of raster layers that can be used for all species that
share the same study region. Otherwise,
'cml', 'min', and 'ker' create a species-specific raster layer.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function creates geographical predictor variables that, together with environmental
variables, can be used to construct constrained species distribution models.
It is recommended to use these approaches to create models that will only be projected for current
conditions and not for different time periods (past or future).</p>
<p>Four methods are implemented:</p>
<p>xy (Latlong method). This method assumes that spatial structure can partially explain species
distribution (Bahn &amp; McGill, 2007). Therefore, two raster layers will be created, containing the
latitude and longitude of pixels, respectively. These raster layers should be included as
covariates with the environmental layers to construct species distribution models. This method
does not interact with species occurrence and is generic for a given study region; for this
reason, it is possible to use this method for all species set that share the same study region.</p>
<p>min (Nearest neighbor distance method). Compiled and adapted from Allouche et al. (2008), this
method calculates for each cell the Euclidean geographic distance to the nearest presence point.</p>
<p>cml (Cumulative distance method). Compiled and adapted from Allouche et al. (2008), this method
assumes that pixels closer to presences are likely included in species distributions. Therefore,
a raster layer will be created containing the sum of Euclidean geographic distances from each
pixel to all occurrences of a species. Obtained values are normalized to vary from zero to one.
This raster layer should be included with the environmental layers to construct species
distribution models.</p>
<p>ker (Kernel method). Compiled and adapted from Allouche et al. (2008), this method, like cml,
assumes that pixels located in areas with a higher density of occurrences are likely included in
the actual species distribution. Thus, a raster layer will be created containing the Gaussian
values based on the density of occurrences of a species. The standard deviation of the Gaussian
distribution was the maximum value in a vector of minimum distances between pairs of occurrences
of a species. Gaussian values are normalized to vary from zero to one. This raster layer should
be included  with the environmental layers to construct species distribution models.</p>

<p>See Mendes et al. (2020) for further methodological and performance details.</p>
<p>If used one these constraining method cite Mendes et al 2020.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p>Mendes, P.; Velazco S.J.E.; Andrade, A.F.A.; De Marco, P. (2020) Dealing with
overprediction in species distribution models: how adding distance constraints can improve model
accuracy, Ecological Modelling, in press. https://doi.org/10.1016/j.ecolmodel.2020.109180</p></li>
<li><p>Allouche, O.; Steinitz, O.; Rotem, D.; Rosenfeld, A.; Kadmon, R. (2008). Incorporating
distance constraints into species distribution models. Journal of Applied Ecology, 45(2),
599-609. doi:10.1111/j.1365-2664.2007.01445.x</p></li>
<li><p>Bahn, V.; McGill, B. J. (2007). Can niche-based distribution models outperform spatial
interpolation? Global Ecology and Biogeography, 16(6), 733-742.
doi:10.1111/j.1466-8238.2007.00331.x</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="msdm_posteriori.html">msdm_posteriori</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"spp"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">somevar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"external/somevar.tif"</span>, package <span class="op">=</span> <span class="st">"flexsdm"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">somevar</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">somevar</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Select the presences of a species</span></span></span>
<span class="r-in"><span><span class="va">occ</span> <span class="op">&lt;-</span> <span class="va">spp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">species</span> <span class="op">==</span> <span class="st">"sp3"</span>, <span class="va">pr_ab</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Select a raster layer to be used as a basic raster</span></span></span>
<span class="r-in"><span><span class="va">a_variable</span> <span class="op">&lt;-</span> <span class="va">somevar</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">a_variable</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">occ</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### xy method</span></span></span>
<span class="r-in"><span><span class="va">m_xy</span> <span class="op">&lt;-</span> <span class="fu">msdm_priori</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">occ</span>,</span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="st">"x"</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="st">"y"</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="st">"xy"</span>,</span></span>
<span class="r-in"><span>  env_layer <span class="op">=</span> <span class="va">a_variable</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m_xy</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### min method</span></span></span>
<span class="r-in"><span><span class="va">m_min</span> <span class="op">&lt;-</span> <span class="fu">msdm_priori</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">occ</span>,</span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="st">"x"</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="st">"y"</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="st">"min"</span>,</span></span>
<span class="r-in"><span>  env_layer <span class="op">=</span> <span class="va">a_variable</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m_min</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### cml method</span></span></span>
<span class="r-in"><span><span class="va">m_cml</span> <span class="op">&lt;-</span> <span class="fu">msdm_priori</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">occ</span>,</span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="st">"x"</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="st">"y"</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="st">"cml"</span>,</span></span>
<span class="r-in"><span>  env_layer <span class="op">=</span> <span class="va">a_variable</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m_cml</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### ker method</span></span></span>
<span class="r-in"><span><span class="va">m_ker</span> <span class="op">&lt;-</span> <span class="fu">msdm_priori</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">occ</span>,</span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="st">"x"</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="st">"y"</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="st">"ker"</span>,</span></span>
<span class="r-in"><span>  env_layer <span class="op">=</span> <span class="va">a_variable</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m_ker</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Santiago J.E. Velazco, Brooke Rose, André F.A. Andrade, Ignacio Minoli, Janet Franklin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

