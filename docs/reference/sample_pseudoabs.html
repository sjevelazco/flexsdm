<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Sample pseudo-absences — sample_pseudoabs • flexsdm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sample pseudo-absences — sample_pseudoabs"><meta name="description" content="This function provide several methods for sampling pseudo-absences, for instance
totally random sampling method, with the options of using different environmental and or geographical constraints."><meta property="og:description" content="This function provide several methods for sampling pseudo-absences, for instance
totally random sampling method, with the options of using different environmental and or geographical constraints."><meta name="google-site-verification" content="gcou8tqRTwNjZ_Mf1kbFgAzzUcY3OF-JB2sPRPTA56I"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">flexsdm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Home"><span class="fa fa-home"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/v01_pre_modeling.html">1. Overview of Pre-modeling functions</a></li>
    <li><a class="dropdown-item" href="../articles/v02_modeling.html">2. Overview of Modeling functions</a></li>
    <li><a class="dropdown-item" href="../articles/v03_post_modeling.html">3. Overview of Post-modeling functions</a></li>
    <li><a class="dropdown-item" href="../articles/v04_Red_fir_example.html">4. An example with Red Fir</a></li>
    <li><a class="dropdown-item" href="../articles/v05_Rare_species_example.html">5. Modeling a rare species</a></li>
    <li><a class="dropdown-item" href="../articles/v06_Extrapolation_example.html">6. Tools to explore extrapolation in SDMs</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/pkg_citation.html">Citations</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/pkg_citation.html">Citations</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
<li class="nav-item"><a class="nav-link" href="https://sjevelazco.github.io/flexsdm" aria-label="GitHub">GitHub</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sjevelazco/flexsdm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Sample pseudo-absences</h1>
      <small class="dont-index">Source: <a href="https://github.com/sjevelazco/flexsdm/blob/HEAD/R/sample_pseudoabs.R" class="external-link"><code>R/sample_pseudoabs.R</code></a></small>
      <div class="d-none name"><code>sample_pseudoabs.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function provide several methods for sampling pseudo-absences, for instance
totally random sampling method, with the options of using different environmental and or geographical constraints.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sample_pseudoabs</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">n</span>,</span>
<span>  <span class="va">method</span>,</span>
<span>  <span class="va">rlayer</span>,</span>
<span>  maskval <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  calibarea <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sp_name <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>data.frame or tibble. Database with presences
(or presence-absence, or presences-pseudo-absence) records, and coordinates</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>character. Column name with spatial x coordinates</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>character. Column name with spatial y coordinates</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>integer. Number of pseudo-absences to be sampled</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>character. Pseudo-absence allocation method. It is necessary to
provide a vector for this argument. The methods implemented are:</p><ul><li><p>random: Random allocation of pseudo-absences throughout the area used for model fitting. Usage method='random'.</p></li>
<li><p>kmeans: Pseudo-absences are sampled randomly within environmental clusters defined by K-means
cluster analysis (the number of clusters will equal than number of pseudo-absences defined in 'n').
For this method, it is necessary to provide a raster object with environmental
variables. Usage method = c('kmeans', env = somevar).
throughout the area used for model fitting. Usage method='random'.</p></li>
<li><p>env_const: Pseudo-absences are environmentally constrained to regions with lower suitability values predicted by a Bioclim model. For this method, it is necessary to provide a raster object with environmental variables Usage method=c(method='env_const', env = somevar).</p></li>
<li><p>geo_const: Pseudo-absences are allocated far from occurrences based on a geographical buffer. A value of the buffer width in m must be provided if raster (used in rlayer) has a longitude/latitude CRS, or in map units in other cases. Usage method=c('geo_const', width='50000').</p></li>
<li><p>geo_env_const: Pseudo-absences are constrained environmentally (based on Bioclim model) and distributed geographically far from occurrences based on a geographical buffer. For this method, a raster with environmental variables stored as SpatRaster object should be provided. A value of the buffer width in m must be provided if raster (used in rlayer) has a longitude/latitude CRS, or in map units in other cases. Usage method=c('geo_env_const', width='50000', env = somevar).</p></li>
<li><p>geo_env_km_const: Pseudo-absences are constrained using a three-level procedure; it is similar to
the geo_env_const with an additional step which distributes the pseudo-absences in environmental space
using K-means cluster analysis. For this method, it is necessary to provide a raster object with
environmental variables and a value of the buffer width in m if raster (used in rlayer) has a
longitude/latitude CRS, or map units in other cases. Usage method=c('geo_env_km_const',
width='50000', env = somevar).</p></li>
</ul></dd>


<dt id="arg-rlayer">rlayer<a class="anchor" aria-label="anchor" href="#arg-rlayer"></a></dt>
<dd><p>SpatRaster. A raster layer used for sampling pseudo-absence
A layer with the same resolution and extent that environmental variables that will be used for modeling is recommended. In the case use maskval argument, this raster layer must contain the values used to constrain sampling</p></dd>


<dt id="arg-maskval">maskval<a class="anchor" aria-label="anchor" href="#arg-maskval"></a></dt>
<dd><p>integer, character, or factor. Values of the raster layer used for constraining the pseudo-absence sampling</p></dd>


<dt id="arg-calibarea">calibarea<a class="anchor" aria-label="anchor" href="#arg-calibarea"></a></dt>
<dd><p>SpatVector A SpatVector which delimit the calibration area used for a given species (see <code><a href="calib_area.html">calib_area</a></code> function).</p></dd>


<dt id="arg-sp-name">sp_name<a class="anchor" aria-label="anchor" href="#arg-sp-name"></a></dt>
<dd><p>character. Species name for which the output will be used.
If this argument is used, the first output column will have the species name. Default NULL.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A tibble object with x y coordinates of sampled pseudo-absence points</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="sample_background.html">sample_background</a></code> and <code><a href="calib_area.html">calib_area</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"spp"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">somevar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"external/somevar.tif"</span>, package <span class="op">=</span> <span class="st">"flexsdm"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">somevar</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">somevar</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">regions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"external/regions.tif"</span>, package <span class="op">=</span> <span class="st">"flexsdm"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">regions</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">regions</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regions</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">single_spp</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="va">spp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">species</span> <span class="op">==</span> <span class="st">"sp3"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pr_ab</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">pr_ab</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Pseudo-absences randomly sampled throughout study area</span></span></span>
<span class="r-in"><span><span class="va">ps1</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">sample_pseudoabs</span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">single_spp</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="st">"x"</span>,</span></span>
<span class="r-in"><span>    y <span class="op">=</span> <span class="st">"y"</span>,</span></span>
<span class="r-in"><span>    n <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>    method <span class="op">=</span> <span class="st">"random"</span>,</span></span>
<span class="r-in"><span>    rlayer <span class="op">=</span> <span class="va">regions</span>,</span></span>
<span class="r-in"><span>    maskval <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>    sp_name <span class="op">=</span> <span class="st">"sp3"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regions</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.colors.html" class="external-link">gray.colors</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span> <span class="co"># presences</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">ps1</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span> <span class="co"># absences</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Pseudo-absences randomly sampled within a regions where a species occurs</span></span></span>
<span class="r-in"><span><span class="co">## Regions where this species occurrs</span></span></span>
<span class="r-in"><span><span class="va">samp_here</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/extract.html" class="external-link">extract</a></span><span class="op">(</span><span class="va">regions</span>, <span class="va">single_spp</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.exclude</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ps1</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">sample_pseudoabs</span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">single_spp</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="st">"x"</span>,</span></span>
<span class="r-in"><span>    y <span class="op">=</span> <span class="st">"y"</span>,</span></span>
<span class="r-in"><span>    n <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>    method <span class="op">=</span> <span class="st">"random"</span>,</span></span>
<span class="r-in"><span>    rlayer <span class="op">=</span> <span class="va">regions</span>,</span></span>
<span class="r-in"><span>    maskval <span class="op">=</span> <span class="va">samp_here</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regions</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.colors.html" class="external-link">gray.colors</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">ps1</span>, col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Pseudo-absences sampled with K-means approach</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ps1</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">sample_pseudoabs</span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">single_spp</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="st">"x"</span>,</span></span>
<span class="r-in"><span>    y <span class="op">=</span> <span class="st">"y"</span>,</span></span>
<span class="r-in"><span>    n <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>    method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">'kmeans'</span>, env <span class="op">=</span> <span class="va">somevar</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    rlayer <span class="op">=</span> <span class="va">regions</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regions</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.colors.html" class="external-link">gray.colors</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">ps1</span>, col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Pseudo-absences sampled with geographical constraint</span></span></span>
<span class="r-in"><span><span class="va">ps1</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">sample_pseudoabs</span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">single_spp</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="st">"x"</span>,</span></span>
<span class="r-in"><span>    y <span class="op">=</span> <span class="st">"y"</span>,</span></span>
<span class="r-in"><span>    n <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>    method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"geo_const"</span>, width <span class="op">=</span> <span class="st">"30000"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    rlayer <span class="op">=</span> <span class="va">regions</span>,</span></span>
<span class="r-in"><span>    maskval <span class="op">=</span> <span class="va">samp_here</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regions</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.colors.html" class="external-link">gray.colors</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">ps1</span>, col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Pseudo-absences sampled with environmental constraint</span></span></span>
<span class="r-in"><span><span class="va">ps1</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">sample_pseudoabs</span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">single_spp</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="st">"x"</span>,</span></span>
<span class="r-in"><span>    y <span class="op">=</span> <span class="st">"y"</span>,</span></span>
<span class="r-in"><span>    n <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>    method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"env_const"</span>, env <span class="op">=</span> <span class="va">somevar</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    rlayer <span class="op">=</span> <span class="va">regions</span>,</span></span>
<span class="r-in"><span>    maskval <span class="op">=</span> <span class="va">samp_here</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regions</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.colors.html" class="external-link">gray.colors</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">ps1</span>, col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Pseudo-absences sampled with environmental and geographical constraint</span></span></span>
<span class="r-in"><span><span class="va">ps1</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">sample_pseudoabs</span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">single_spp</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="st">"x"</span>,</span></span>
<span class="r-in"><span>    y <span class="op">=</span> <span class="st">"y"</span>,</span></span>
<span class="r-in"><span>    n <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>    method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"geo_env_const"</span>, width <span class="op">=</span> <span class="st">"50000"</span>, env <span class="op">=</span> <span class="va">somevar</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    rlayer <span class="op">=</span> <span class="va">regions</span>,</span></span>
<span class="r-in"><span>    maskval <span class="op">=</span> <span class="va">samp_here</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regions</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.colors.html" class="external-link">gray.colors</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">ps1</span>, col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Pseudo-absences sampled with environmental and geographical constraint and with k-mean clustering</span></span></span>
<span class="r-in"><span><span class="va">ps1</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">sample_pseudoabs</span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">single_spp</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="st">"x"</span>,</span></span>
<span class="r-in"><span>    y <span class="op">=</span> <span class="st">"y"</span>,</span></span>
<span class="r-in"><span>    n <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>    method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"geo_env_km_const"</span>, width <span class="op">=</span> <span class="st">"50000"</span>, env <span class="op">=</span> <span class="va">somevar</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    rlayer <span class="op">=</span> <span class="va">regions</span>,</span></span>
<span class="r-in"><span>    maskval <span class="op">=</span> <span class="va">samp_here</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regions</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.colors.html" class="external-link">gray.colors</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">ps1</span>, col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Sampling pseudo-absence using a calibration area</span></span></span>
<span class="r-in"><span><span class="va">ca_ps1</span> <span class="op">&lt;-</span> <span class="fu"><a href="calib_area.html">calib_area</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">single_spp</span>,</span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="st">"x"</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="st">"y"</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"buffer"</span>, width <span class="op">=</span> <span class="fl">50000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  crs <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/crs.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">somevar</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regions</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.colors.html" class="external-link">gray.colors</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ca_ps1</span>, add <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ps1</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">sample_pseudoabs</span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">single_spp</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="st">"x"</span>,</span></span>
<span class="r-in"><span>    y <span class="op">=</span> <span class="st">"y"</span>,</span></span>
<span class="r-in"><span>    n <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">)</span> <span class="op">*</span> <span class="fl">50</span>,</span></span>
<span class="r-in"><span>    method <span class="op">=</span> <span class="st">"random"</span>,</span></span>
<span class="r-in"><span>    rlayer <span class="op">=</span> <span class="va">regions</span>,</span></span>
<span class="r-in"><span>    maskval <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>    calibarea <span class="op">=</span> <span class="va">ca_ps1</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regions</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.colors.html" class="external-link">gray.colors</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ca_ps1</span>, add <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">ps1</span>, col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ps1</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">sample_pseudoabs</span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">single_spp</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="st">"x"</span>,</span></span>
<span class="r-in"><span>    y <span class="op">=</span> <span class="st">"y"</span>,</span></span>
<span class="r-in"><span>    n <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">)</span> <span class="op">*</span> <span class="fl">50</span>,</span></span>
<span class="r-in"><span>    method <span class="op">=</span> <span class="st">"random"</span>,</span></span>
<span class="r-in"><span>    rlayer <span class="op">=</span> <span class="va">regions</span>,</span></span>
<span class="r-in"><span>    maskval <span class="op">=</span> <span class="va">samp_here</span>,</span></span>
<span class="r-in"><span>    calibarea <span class="op">=</span> <span class="va">ca_ps1</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regions</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.colors.html" class="external-link">gray.colors</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ca_ps1</span>, add <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">ps1</span>, col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Santiago J.E. Velazco, Brooke Rose, André F.A. Andrade, Ignacio Minoli, Janet Franklin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

