<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Collinearity reduction of predictor variables — correct_colinvar • flexsdm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Collinearity reduction of predictor variables — correct_colinvar"><meta name="description" content="Collinearity reduction of predictor variables"><meta property="og:description" content="Collinearity reduction of predictor variables"><meta name="google-site-verification" content="gcou8tqRTwNjZ_Mf1kbFgAzzUcY3OF-JB2sPRPTA56I"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">flexsdm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Home"><span class="fa fa-home"></span> Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/v01_pre_modeling.html">1. Overview of Pre-modeling functions</a></li>
    <li><a class="dropdown-item" href="../articles/v02_modeling.html">2. Overview of Modeling functions</a></li>
    <li><a class="dropdown-item" href="../articles/v03_post_modeling.html">3. Overview of Post-modeling functions</a></li>
    <li><a class="dropdown-item" href="../articles/v04_Red_fir_example.html">4. An example with Red Fir</a></li>
    <li><a class="dropdown-item" href="../articles/v05_Rare_species_example.html">5. Modeling a rare species</a></li>
    <li><a class="dropdown-item" href="../articles/v06_Extrapolation_example.html">6. Tools to explore extrapolation in SDMs</a></li>
    <li><a class="dropdown-item" href="../articles/v07_Complete_workflow.html">7. Modeling workflow for several species</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/pkg_citation.html">Citations</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/pkg_citation.html">Citations</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
<li class="nav-item"><a class="nav-link" href="https://sjevelazco.github.io/flexsdm" aria-label="GitHub">GitHub</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sjevelazco/flexsdm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Collinearity reduction of predictor variables</h1>
      <small class="dont-index">Source: <a href="https://github.com/sjevelazco/flexsdm/blob/HEAD/R/correct_colinvar.R" class="external-link"><code>R/correct_colinvar.R</code></a></small>
      <div class="d-none name"><code>correct_colinvar.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Collinearity reduction of predictor variables</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">correct_colinvar</span><span class="op">(</span></span>
<span>  <span class="va">env_layer</span>,</span>
<span>  <span class="va">method</span>,</span>
<span>  proj <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  save_proj <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  restric_to_region <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  restric_pca_proj <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  maxcell <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  based_on_points <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-env-layer">env_layer<a class="anchor" aria-label="anchor" href="#arg-env-layer"></a></dt>
<dd><p>SpatRaster An object of class SpatRaster containing the predictors.
This function does not allow categorical variables</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>character. Collinearity reduction method. It is necessary to
provide a vector for this argument. The next methods are implemented:</p><ul><li><p>pearson: Highlights correlated variables according to Pearson correlation. A threshold of maximum correlation
  must be specified. Otherwise, a threshold of 0.7 is defined as default.
  Usage method = c('pearson', th='0.7').</p></li>
<li><p>vif: Select variables by Variance Inflation Factor, a threshold can be specified by
  user. Otherwise, a threshold of 10 is defined as default.Usage method = c('vif', th = '10').</p></li>
<li><p>pca: Perform a Principal Component Analysis and use the principal components as the
  new predictors. The selected components account for 95% of the whole variation in the system.
  Usage method = c('pca').</p></li>
<li><p>fa: Perform a Factorial Analysis and select, from the original predictors, the number of factors is defined by Broken-Stick and variables with the highest correlation to the factors are selected.  Usage method = c('fa').</p></li>
</ul></dd>


<dt id="arg-proj">proj<a class="anchor" aria-label="anchor" href="#arg-proj"></a></dt>
<dd><p>character. Only used for pca method. Path to a folder that contains sub-folders for the different projection
scenarios. Variables names must have the same names as in the raster used in env_layer argument. Usage proj = "C:/User/Desktop/Projections" (see in Details more about the use of this argument)</p></dd>


<dt id="arg-save-proj">save_proj<a class="anchor" aria-label="anchor" href="#arg-save-proj"></a></dt>
<dd><p>character. Directory to save PCA projection. Default NULL.</p></dd>


<dt id="arg-restric-to-region">restric_to_region<a class="anchor" aria-label="anchor" href="#arg-restric-to-region"></a></dt>
<dd><p>SpatVector. Area used to restrict cells of env_layer at moment to perform collinearity reduction. Default: NULL.</p></dd>


<dt id="arg-restric-pca-proj">restric_pca_proj<a class="anchor" aria-label="anchor" href="#arg-restric-pca-proj"></a></dt>
<dd><p>logical. Area used to restrict geographically PCA projection within SpatVector used in restric_to_region. Only use for PCA analysis. Default: FALSE.</p></dd>


<dt id="arg-maxcell">maxcell<a class="anchor" aria-label="anchor" href="#arg-maxcell"></a></dt>
<dd><p>numeric. Number of raster cells to be randomly sampled. Taking a sample could be
useful to reduce memory usage for large rasters. If NULL, the function will use all
raster cells. Default NULL. Usage maxcell = 50000.</p></dd>


<dt id="arg-based-on-points">based_on_points<a class="anchor" aria-label="anchor" href="#arg-based-on-points"></a></dt>
<dd><p>logical. If TRUE, collinearity reduction method will be based on species points data (i.e., presences, and absences, pseudo-absences or background points). If TRUE, data, x and y arguments must be provided. Default FALSE.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>tibble or data.frame. Database with species data used to model
(i.e., presence + absence, or presence + pseudo-absence + background points)
with x and y coordinates</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>character. Column name with spatial x coordinates</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>character. Column name with spatial y coordinates</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>#' If 'pearson', returns a list with the following elements:</p><ul><li><p>cor_table: a matrix object with pairwise correlation values of the environmental variables</p></li>
<li><p>cor_variables: a list object with the same length of the number of environmental
 values containing the pairwise relations that exceeded the correlation
 threshold for each one of the environmental variables</p></li>
</ul><p>If 'vif' method, returns a list with the following elements:</p><ul><li><p>env_layer: a SpatRaster object with selected environmental variables</p></li>
<li><p>removed_variables: a character vector with removed environmental variables</p></li>
<li><p>vif_table: a data frame with VIF values for all environmental variables</p></li>
</ul><p>If 'pca' method, returns a list with the following elements:</p><ul><li><p>env_layer: SpatRaster with scores of selected principal component (PC) that sum up 95% of the
whole variation or original environmental variables</p></li>
<li><p>coefficients: a matrix with the coefficient of principal component (PC) for predictors</p></li>
<li><p>cumulative_variance: a tibble with the cumulative variance explained in selected principal component (PC)</p></li>
</ul><p>If 'fa' method, returns a list with the following elements:</p><ul><li><p>env_layer: SpatRaster with scores of selected variables due to correlation to factors.</p></li>
<li><p>number_factors: number of factors selected according to the Broken-Stick criteria,</p></li>
<li><p>removed_variables: removed variables,</p></li>
<li><p>uniqueness: uniqueness of each environmental variable according to the factorial analysis,</p></li>
<li><p>loadings: environmental variables loadings in each of the chosen factors</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>In the case of having environmental variables for the current conditions and other time
periods (future or present), it is recommended to perform the PCA analysis with the current
environmental condition and project the PCA for the other time periods. To do so, it is necessary
to use “proj” argument. Path to a folder (e.g., projections) that contains sub-folders for the
different projection scenarios (e.g., years and emissions). Within each sub-folder must be stored
single or multiband rasters with the environmental variables.</p>
<p>For example:</p>
<p>C:/Users/my_pc/projections/ <br>
    ├── MRIESM_2050_ssp126 <br>
    │   └── var1.tif<br>
    │   └── var2.tif<br>
    │   └── var3.tif<br>
    ├── MRIESM_2080_ssp585<br>
    │   └── var1.tif<br>
    │   └── var2.tif<br>
    │   └── var3.tif<br>
    ├── UKESM_2050_ssp370<br>
    │   └── var1.tif<br>
    │   └── var2.tif<br>
    │   └── var3.tif</p>
<p>If pca method is run with time projections, correct_colinvar function will create the
Projection_PCA (the exact path is in the path object returned by the function) with the same
system of sub-folders and multiband raster with the principal components (pcs.tif)</p>
<p>C:/Users/my_pc/Projection_PCA/<br>
      ├── MRIESM_2050_ssp126<br>
      │   └── pcs.tif           # a multiband tif with principal components<br>
      ├── MRIESM_2080_ssp585<br>
      │   └── pcs.tif<br>
      ├── UKESM_2050_ssp370<br>
      │   └── pcs.tif</p>
<p>Perform collinearity reduction based on points</p>
<p>Evaluating collinearity based on all environmental conditions of a
calibration area or study area could yield different results than evaluating
collinearity based on points used to construct the models. If you want to
perform collinearity reduction based on species points data, it is strongly
recommended to use all the point data used for modeling
(i.e., presence + absence or presence + pseudo-absence/background points).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">somevar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"external/somevar.tif"</span>, package <span class="op">=</span> <span class="st">"flexsdm"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">somevar</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">somevar</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perform pearson collinearity control</span></span></span>
<span class="r-in"><span><span class="va">var</span> <span class="op">&lt;-</span> <span class="fu">correct_colinvar</span><span class="op">(</span>env_layer <span class="op">=</span> <span class="va">somevar</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pearson"</span>, th <span class="op">=</span> <span class="st">"0.7"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">var</span><span class="op">$</span><span class="va">cor_table</span></span></span>
<span class="r-in"><span><span class="va">var</span><span class="op">$</span><span class="va">cor_variables</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># For all correct_colinvar methods it is possible to take a sample or raster to reduce memory</span></span></span>
<span class="r-in"><span><span class="va">var</span> <span class="op">&lt;-</span> <span class="fu">correct_colinvar</span><span class="op">(</span>env_layer <span class="op">=</span> <span class="va">somevar</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pearson"</span>, th <span class="op">=</span> <span class="st">"0.7"</span><span class="op">)</span>, maxcell <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">var</span><span class="op">$</span><span class="va">cor_table</span></span></span>
<span class="r-in"><span><span class="va">var</span><span class="op">$</span><span class="va">cor_variables</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perform vif collinearity control</span></span></span>
<span class="r-in"><span><span class="va">var</span> <span class="op">&lt;-</span> <span class="fu">correct_colinvar</span><span class="op">(</span>env_layer <span class="op">=</span> <span class="va">somevar</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vif"</span>, th <span class="op">=</span> <span class="st">"8"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">var</span><span class="op">$</span><span class="va">env_layer</span></span></span>
<span class="r-in"><span><span class="va">var</span><span class="op">$</span><span class="va">removed_variables</span></span></span>
<span class="r-in"><span><span class="va">var</span><span class="op">$</span><span class="va">vif_table</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perform pca collinearity control</span></span></span>
<span class="r-in"><span><span class="va">var</span> <span class="op">&lt;-</span> <span class="fu">correct_colinvar</span><span class="op">(</span>env_layer <span class="op">=</span> <span class="va">somevar</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pca"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">var</span><span class="op">$</span><span class="va">env_layer</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">var</span><span class="op">$</span><span class="va">env_layer</span></span></span>
<span class="r-in"><span><span class="va">var</span><span class="op">$</span><span class="va">coefficients</span></span></span>
<span class="r-in"><span><span class="va">var</span><span class="op">$</span><span class="va">cumulative_variance</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perform pca collinearity control with different projections</span></span></span>
<span class="r-in"><span><span class="co">## Below will be created a set of folders to simulate the structure of the</span></span></span>
<span class="r-in"><span><span class="co">## directory where environmental variables are stored for different scenarios</span></span></span>
<span class="r-in"><span><span class="va">dir_sc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"projections"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">dir_sc</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dir_sc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">dir_sc</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"scenario_1"</span>, <span class="st">"scenario_2"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">dir_sc</span>, <span class="va">dir.create</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">somevar</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"external/somevar.tif"</span>, package <span class="op">=</span> <span class="st">"flexsdm"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">somevar</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">somevar</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/writeRaster.html" class="external-link">writeRaster</a></span><span class="op">(</span><span class="va">somevar</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">dir_sc</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">"somevar.tif"</span><span class="op">)</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/writeRaster.html" class="external-link">writeRaster</a></span><span class="op">(</span><span class="va">somevar</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">dir_sc</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="st">"somevar.tif"</span><span class="op">)</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Perform pca with projections</span></span></span>
<span class="r-in"><span><span class="va">dir_w_proj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">dirname</a></span><span class="op">(</span><span class="va">dir_sc</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dir_w_proj</span></span></span>
<span class="r-in"><span><span class="va">var</span> <span class="op">&lt;-</span> <span class="fu">correct_colinvar</span><span class="op">(</span>env_layer <span class="op">=</span> <span class="va">somevar</span>, method <span class="op">=</span> <span class="st">"pca"</span>, proj <span class="op">=</span> <span class="va">dir_w_proj</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">var</span><span class="op">$</span><span class="va">env_layer</span></span></span>
<span class="r-in"><span><span class="va">var</span><span class="op">$</span><span class="va">coefficients</span></span></span>
<span class="r-in"><span><span class="va">var</span><span class="op">$</span><span class="va">cumulative_variance</span></span></span>
<span class="r-in"><span><span class="va">var</span><span class="op">$</span><span class="va">proj</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perform fa colinearity control</span></span></span>
<span class="r-in"><span><span class="va">var</span> <span class="op">&lt;-</span> <span class="fu">correct_colinvar</span><span class="op">(</span>env_layer <span class="op">=</span> <span class="va">somevar</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fa"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">var</span><span class="op">$</span><span class="va">env_layer</span></span></span>
<span class="r-in"><span><span class="va">var</span><span class="op">$</span><span class="va">number_factors</span></span></span>
<span class="r-in"><span><span class="va">var</span><span class="op">$</span><span class="va">removed_variables</span></span></span>
<span class="r-in"><span><span class="va">var</span><span class="op">$</span><span class="va">uniqueness</span></span></span>
<span class="r-in"><span><span class="va">var</span><span class="op">$</span><span class="va">loadings</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## %######################################################%##</span></span></span>
<span class="r-in"><span><span class="co">#                                                          #</span></span></span>
<span class="r-in"><span><span class="co">####            Other option to perform PCA             ####</span></span></span>
<span class="r-in"><span><span class="co">####      considering cell restricted to a region       ####</span></span></span>
<span class="r-in"><span><span class="co">#                                                          #</span></span></span>
<span class="r-in"><span><span class="co">## %######################################################%##</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"abies"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define a calibration area</span></span></span>
<span class="r-in"><span><span class="va">abies2</span> <span class="op">&lt;-</span> <span class="va">abies</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">pr_ab</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pr_ab</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">somevar</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">abies2</span><span class="op">[</span><span class="op">-</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ca</span> <span class="op">&lt;-</span> <span class="fu"><a href="calib_area.html">calib_area</a></span><span class="op">(</span><span class="va">abies2</span>, x <span class="op">=</span> <span class="st">"x"</span>, y <span class="op">=</span> <span class="st">"y"</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mcp"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/crs.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">somevar</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ca</span>, add <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Full geographical range to perform PCA</span></span></span>
<span class="r-in"><span><span class="va">pca_fr</span> <span class="op">&lt;-</span> <span class="fu">correct_colinvar</span><span class="op">(</span></span></span>
<span class="r-in"><span>  env_layer <span class="op">=</span> <span class="va">somevar</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pca"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  maxcell <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  restric_to_region <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  restric_pca_proj <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perform PCA only with cell delimited by polygon used in restric_to_region</span></span></span>
<span class="r-in"><span><span class="va">pca_rr</span> <span class="op">&lt;-</span> <span class="fu">correct_colinvar</span><span class="op">(</span></span></span>
<span class="r-in"><span>  env_layer <span class="op">=</span> <span class="va">somevar</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pca"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  maxcell <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  restric_to_region <span class="op">=</span> <span class="va">ca</span>,</span></span>
<span class="r-in"><span>  restric_pca_proj <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perform and predicted PCA only with cell delimited by polygon used in restric_to_region</span></span></span>
<span class="r-in"><span><span class="va">pca_rrp</span> <span class="op">&lt;-</span> <span class="fu">correct_colinvar</span><span class="op">(</span></span></span>
<span class="r-in"><span>  env_layer <span class="op">=</span> <span class="va">somevar</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pca"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  maxcell <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  restric_to_region <span class="op">=</span> <span class="va">ca</span>,</span></span>
<span class="r-in"><span>  restric_pca_proj <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pca_fr</span><span class="op">$</span><span class="va">env_layer</span><span class="op">)</span> <span class="co"># PCA with all cells</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pca_rr</span><span class="op">$</span><span class="va">env_layer</span><span class="op">)</span> <span class="co"># PCA with calibration area cell but predicted for entire region</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pca_rrp</span><span class="op">$</span><span class="va">env_layer</span><span class="op">)</span> <span class="co"># PCA performed and predicted for cells within calibration area (ca)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## %######################################################%##</span></span></span>
<span class="r-in"><span><span class="co">#                                                          #</span></span></span>
<span class="r-in"><span><span class="co">####       Use correct_colinvar with points data        ####</span></span></span>
<span class="r-in"><span><span class="co">#                                                          #</span></span></span>
<span class="r-in"><span><span class="co">## %######################################################%##</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"abies"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Presence-absence database</span></span></span>
<span class="r-in"><span><span class="va">abies2</span> <span class="op">&lt;-</span> <span class="va">abies</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">pr_ab</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perform collinearity control</span></span></span>
<span class="r-in"><span><span class="co"># Pearson</span></span></span>
<span class="r-in"><span><span class="fu">correct_colinvar</span><span class="op">(</span></span></span>
<span class="r-in"><span>  env_layer <span class="op">=</span> <span class="va">somevar</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pearson"</span>, th <span class="op">=</span> <span class="st">"0.6"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  based_on_points <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">abies2</span>,</span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="st">"x"</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="st">"y"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># VIF</span></span></span>
<span class="r-in"><span><span class="fu">correct_colinvar</span><span class="op">(</span></span></span>
<span class="r-in"><span>  env_layer <span class="op">=</span> <span class="va">somevar</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vif"</span>, th <span class="op">=</span> <span class="st">"8"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  based_on_points <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">abies2</span>,</span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="st">"x"</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="st">"y"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># PCA</span></span></span>
<span class="r-in"><span><span class="fu">correct_colinvar</span><span class="op">(</span></span></span>
<span class="r-in"><span>  env_layer <span class="op">=</span> <span class="va">somevar</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pca"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  based_on_points <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">abies2</span>,</span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="st">"x"</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="st">"y"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># FA</span></span></span>
<span class="r-in"><span><span class="fu">correct_colinvar</span><span class="op">(</span></span></span>
<span class="r-in"><span>  env_layer <span class="op">=</span> <span class="va">somevar</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="st">"fa"</span>,</span></span>
<span class="r-in"><span>  based_on_points <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">abies2</span>,</span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="st">"x"</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="st">"y"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Santiago J.E. Velazco, Brooke Rose, André F.A. Andrade, Ignacio Minoli, Janet Franklin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

